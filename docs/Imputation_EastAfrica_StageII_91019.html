<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>East Africa Imputation 2019 - Stage II</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      code.sourceCode > span { display: inline-block; line-height: 1.25; }
  code.sourceCode > span { color: inherit; text-decoration: inherit; }
  code.sourceCode > span:empty { height: 1.2em; }
  .sourceCode { overflow: visible; }
  code.sourceCode { white-space: pre; position: relative; }
  div.sourceCode { margin: 1em 0; }
  pre.sourceCode { margin: 0; }
  @media screen {
  div.sourceCode { overflow: auto; }
  }
  @media print {
  code.sourceCode { white-space: pre-wrap; }
  code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
  }
  pre.numberSource code
    { counter-reset: source-line 0; }
  pre.numberSource code > span
    { position: relative; left: -4em; counter-increment: source-line; }
  pre.numberSource code > span > a:first-child::before
    { content: counter(source-line);
      position: relative; left: -1em; text-align: right; vertical-align: baseline;
      border: none; display: inline-block;
      -webkit-touch-callout: none; -webkit-user-select: none;
      -khtml-user-select: none; -moz-user-select: none;
      -ms-user-select: none; user-select: none;
      padding: 0 4px; width: 4em;
      color: #aaaaaa;
    }
  pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
  div.sourceCode
    {  background-color: #f8f8f8; }
  @media screen {
  code.sourceCode > span > a:first-child::before { text-decoration: underline; }
  }
  code span.al { color: #ef2929; } /* Alert */
  code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
  code span.at { color: #c4a000; } /* Attribute */
  code span.bn { color: #0000cf; } /* BaseN */
  code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
  code span.ch { color: #4e9a06; } /* Char */
  code span.cn { color: #000000; } /* Constant */
  code span.co { color: #8f5902; font-style: italic; } /* Comment */
  code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
  code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
  code span.dt { color: #204a87; } /* DataType */
  code span.dv { color: #0000cf; } /* DecVal */
  code span.er { color: #a40000; font-weight: bold; } /* Error */
  code span.ex { } /* Extension */
  code span.fl { color: #0000cf; } /* Float */
  code span.fu { color: #000000; } /* Function */
  code span.im { } /* Import */
  code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
  code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
  code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
  code span.ot { color: #8f5902; } /* Other */
  code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
  code span.sc { color: #000000; } /* SpecialChar */
  code span.ss { color: #4e9a06; } /* SpecialString */
  code span.st { color: #4e9a06; } /* String */
  code span.va { color: #000000; } /* Variable */
  code span.vs { color: #4e9a06; } /* VerbatimString */
  code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NaCRRI_2020GS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Imputation 2019
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="convertDArTseqLD_to_VCF_82719.html">Conversion DArT report to VCF</a>
    </li>
    <li>
      <a href="Verify_gbs2dart_sampleMatches_82819.html">Verify GBS-to-DArTseqLD sample matches</a>
    </li>
    <li>
      <a href="Imputation_EastAfrica_StageI_82819.html">Imputation Stage I</a>
    </li>
    <li>
      <a href="Imputation_EastAfrica_StageII_91019.html">Imputation Stage II</a>
    </li>
    <li>
      <a href="Imputation_EastAfrica_StageIII_91119.html">Imputation Stage III</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Imputation 2020
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="convertDCas20_5419_ToVCF.html">Conversion DArT report DCas20_5419 to VCF</a>
    </li>
    <li>
      <a href="ImputeDCas20_5419.html">Impute DCas20_5419</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about.html">About</a>
    </li>
    <li>
      <a href="license.html">License</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/wolfemd/NaCRRI_2020GS">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">East Africa Imputation 2019 - Stage II</h1>
<h4 class="date">2019-September-10</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2020-10-09
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>NaCRRI_2020GS/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20200826code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20200826)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20200826code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20200826)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefUsersmw489GoogleDriveNextGenGSEMBRAPA2020GStreebcbcec37ccc91d22f5e3ac898fbdc24c550b7ea4targetblankbcbcec3a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="/Users/mw489/Google Drive/NextGenGS/EMBRAPA_2020GS/./tree/bcbcec37ccc91d22f5e3ac898fbdc24c550b7ea4" target="_blank">bcbcec3</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefUsersmw489GoogleDriveNextGenGSEMBRAPA2020GStreebcbcec37ccc91d22f5e3ac898fbdc24c550b7ea4targetblankbcbcec3a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="/Users/mw489/Google Drive/NextGenGS/EMBRAPA_2020GS/./tree/bcbcec37ccc91d22f5e3ac898fbdc24c550b7ea4" target="_blank">bcbcec3</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rproj.user/
    Ignored:    analysis/.DS_Store
    Ignored:    data/.DS_Store

Untracked files:
    Untracked:  data/Report-DCas20-5419/
    Untracked:  output/BeagleLogs/
    Untracked:  output/DosageMatrix_DCas20_5419_EA_REFimputedAndFiltered.rds
    Untracked:  output/DosageMatrix_DCas20_5419_LA_REFimputedAndFiltered.rds
    Untracked:  output/chr10_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr10_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr10_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr10_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr10_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr10_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr10_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr10_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr10_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr10_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr10_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr10_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr10_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr10_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr10_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr10_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr10_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr10_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr10_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr10_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr10_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr10_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr11_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr11_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr11_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr11_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr11_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr11_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr11_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr11_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr11_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr11_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr11_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr11_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr11_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr11_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr11_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr11_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr11_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr11_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr11_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr11_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr11_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr11_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr12_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr12_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr12_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr12_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr12_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr12_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr12_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr12_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr12_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr12_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr12_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr12_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr12_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr12_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr12_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr12_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr12_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr12_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr12_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr12_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr12_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr12_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr13_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr13_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr13_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr13_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr13_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr13_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr13_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr13_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr13_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr13_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr13_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr13_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr13_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr13_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr13_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr13_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr13_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr13_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr13_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr13_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr13_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr13_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr14_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr14_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr14_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr14_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr14_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr14_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr14_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr14_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr14_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr14_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr14_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr14_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr14_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr14_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr14_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr14_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr14_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr14_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr14_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr14_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr14_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr14_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr15_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr15_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr15_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr15_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr15_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr15_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr15_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr15_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr15_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr15_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr15_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr15_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr15_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr15_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr15_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr15_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr15_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr15_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr15_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr15_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr15_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr15_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr16_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr16_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr16_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr16_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr16_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr16_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr16_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr16_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr16_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr16_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr16_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr16_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr16_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr16_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr16_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr16_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr16_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr16_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr16_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr16_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr16_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr16_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr17_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr17_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr17_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr17_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr17_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr17_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr17_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr17_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr17_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr17_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr17_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr17_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr17_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr17_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr17_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr17_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr17_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr17_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr17_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr17_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr17_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr17_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr18_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr18_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr18_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr18_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr18_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr18_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr18_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr18_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr18_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr18_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr18_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr18_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr18_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr18_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr18_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr18_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr18_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr18_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr18_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr18_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr18_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr18_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr1_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr1_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr1_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr1_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr1_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr1_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr1_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr1_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr1_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr1_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr1_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr1_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr1_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr1_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr1_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr1_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr1_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr1_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr1_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr1_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr1_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr1_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr2_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr2_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr2_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr2_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr2_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr2_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr2_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr2_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr2_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr2_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr2_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr2_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr2_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr2_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr2_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr2_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr2_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr2_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr2_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr2_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr2_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr2_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr3_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr3_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr3_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr3_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr3_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr3_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr3_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr3_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr3_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr3_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr3_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr3_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr3_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr3_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr3_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr3_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr3_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr3_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr3_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr3_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr3_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr3_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr4_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr4_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr4_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr4_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr4_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr4_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr4_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr4_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr4_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr4_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr4_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr4_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr4_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr4_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr4_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr4_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr4_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr4_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr4_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr4_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr4_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr4_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr5_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr5_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr5_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr5_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr5_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr5_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr5_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr5_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr5_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr5_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr5_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr5_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr5_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr5_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr5_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr5_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr5_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr5_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr5_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr5_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr5_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr5_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr6_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr6_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr6_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr6_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr6_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr6_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr6_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr6_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr6_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr6_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr6_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr6_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr6_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr6_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr6_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr6_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr6_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr6_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr6_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr6_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr6_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr6_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr7_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr7_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr7_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr7_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr7_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr7_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr7_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr7_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr7_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr7_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr7_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr7_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr7_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr7_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr7_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr7_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr7_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr7_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr7_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr7_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr7_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr7_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr8_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr8_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr8_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr8_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr8_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr8_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr8_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr8_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr8_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr8_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr8_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr8_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr8_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr8_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr8_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr8_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr8_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr8_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr8_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr8_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr8_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr8_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr9_DCas20_5419_EA_REFimputed.INFO
    Untracked:  output/chr9_DCas20_5419_EA_REFimputed.hwe
    Untracked:  output/chr9_DCas20_5419_EA_REFimputed.log
    Untracked:  output/chr9_DCas20_5419_EA_REFimputed.sitesPassing
    Untracked:  output/chr9_DCas20_5419_EA_REFimputed.vcf.gz
    Untracked:  output/chr9_DCas20_5419_EA_REFimputedAndFiltered.bed
    Untracked:  output/chr9_DCas20_5419_EA_REFimputedAndFiltered.bim
    Untracked:  output/chr9_DCas20_5419_EA_REFimputedAndFiltered.fam
    Untracked:  output/chr9_DCas20_5419_EA_REFimputedAndFiltered.log
    Untracked:  output/chr9_DCas20_5419_EA_REFimputedAndFiltered.nosex
    Untracked:  output/chr9_DCas20_5419_EA_REFimputedAndFiltered.raw
    Untracked:  output/chr9_DCas20_5419_EA_REFimputedAndFiltered.vcf.gz
    Untracked:  output/chr9_DCas20_5419_EAplusLA_REFimputedAndFiltered.log
    Untracked:  output/chr9_DCas20_5419_LA_REFimputed.log
    Untracked:  output/chr9_DCas20_5419_LA_REFimputed.vcf.gz
    Untracked:  output/chr9_DCas20_5419_LA_REFimputedAndFiltered.bed
    Untracked:  output/chr9_DCas20_5419_LA_REFimputedAndFiltered.bim
    Untracked:  output/chr9_DCas20_5419_LA_REFimputedAndFiltered.fam
    Untracked:  output/chr9_DCas20_5419_LA_REFimputedAndFiltered.log
    Untracked:  output/chr9_DCas20_5419_LA_REFimputedAndFiltered.nosex
    Untracked:  output/chr9_DCas20_5419_LA_REFimputedAndFiltered.raw
    Untracked:  output/chr9_DCas20_5419_LA_REFimputedAndFiltered.vcf.gz
    Untracked:  workflowr_log.R

Unstaged changes:
    Deleted:    EMBRAPA_2020GS.Rproj
    Deleted:    analysis/Imputation_EMBRAPA_102419.Rmd
    Deleted:    analysis/ImputeDCas20_5360.Rmd
    Deleted:    analysis/Verify_gbs2dart_sampleMatches_EMBRAPA_102419.Rmd
    Deleted:    analysis/convertDCas19_4403_ToVCF_102419.Rmd
    Deleted:    analysis/convertDCas20_5360_ToVCF.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/Imputation_EastAfrica_StageII_91019.Rmd</code>) and HTML (<code>docs/Imputation_EastAfrica_StageII_91019.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
html
</td>
<td>
<a href="/Users/mw489/Google Drive/NextGenGS/EMBRAPA_2020GS/./blob/c6022b62c22b4af75abce44157bc20c26191afbc/docs/Imputation_EastAfrica_StageII_91019.html" target="_blank">c6022b6</a>
</td>
<td>
wolfemd
</td>
<td>
2020-10-09
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="/Users/mw489/Google Drive/NextGenGS/EMBRAPA_2020GS/./blob/4f8a229950ea3e4858b03edda1b13894dcdec908/analysis/Imputation_EastAfrica_StageII_91019.Rmd" target="_blank">4f8a229</a>
</td>
<td>
wolfemd
</td>
<td>
2020-10-09
</td>
<td>
Publish imputations for 2020 of DCAs20_5360 (and 2019 code too) for
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="make-directory-cbsurobbins" class="section level1">
<h1>Make Directory (@ cbsurobbins)</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>mkdir <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>MapforBeagle</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">tibble</span>(<span class="dt">CHR=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">CHROMdata=</span><span class="kw">map</span>(CHR,<span class="op">~</span><span class="kw">read.table</span>(<span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;~/Google Drive/NextGenGS/nextgenImputation2019/&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>                                                   <span class="st">&quot;CassavaGeneticMap/chr&quot;</span>,.,<span class="st">&quot;_cassava_cM_pred.v6_90619.map&quot;</span>),</span>
<span id="cb2-5"><a href="#cb2-5"></a>                                        <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span>dim</span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="kw">ggplot</span>(.,<span class="kw">aes</span>(<span class="dt">x=</span>V4,<span class="dt">y=</span>V3)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>CHR)</span></code></pre></div>
</div>
<div id="prepare-imputation-target-samples-with-gbs-only" class="section level1">
<h1>Prepare imputation target: Samples with GBS-only</h1>
<p>GBS-only samples from NaCRRI and TARI Mostly will include NaCRRI C1 but also might be some TARI TP (those whose new samples weren’t verified). Use previously REF imputed data in order to only require Beagle 5.1</p>
<div id="get-data" class="section level2">
<h2>Get data</h2>
<p>Get Tanzania imputed data from:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">ssh</span> -p 8022 mw489@login.sgn.cornell.edu</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">scp</span> -r /export/species/Manihot_esculenta_old/gbs/IGDbuildNewWithV6/genotypeFiles_VCFformat_filtered_imputed/beagle_GBS_june17 mw489@cbsurobbins.biohpc.cornell.edu:/workdir/marnin/</span></code></pre></div>
</div>
<div id="samples" class="section level2">
<h2>Samples</h2>
<p>Samples NOT in RefPanelIV from 1) /workdir/marnin/beagle_GBS_june17 (imputed Tz data) 2) /workdir/marnin/beagle_GBS_october2016/CYCLE_NACRRI_june16/vcf/ (NaCRRI C1)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">library</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;bcftools query --list-samples /workdir/marnin/beagle_GBS_june17/TanzaniaData_20170601_withRef/&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3"></a>              <span class="st">&quot;TanzaniaData_20170601_withRef_chr1.filt2.imputed.vcf.gz &quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4"></a>              <span class="st">&quot;&gt; /workdir/marnin/beagle_GBS_june17/TanzaniaData_20170601_withRef/&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5"></a>              <span class="st">&quot;TanzaniaData_20170601_withRef_chr1.filt2.imputed.samples&quot;</span>))</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;bcftools query --list-samples /workdir/marnin/beagle_GBS_october2016/CYCLE_NACRRI_june16/vcf/&quot;</span>,</span>
<span id="cb4-7"><a href="#cb4-7"></a>              <span class="st">&quot;Subset_cassavaGBSbuild_June2016_withRef_NACCRI_CYCLE_chr1.imputed.vcf.gz &quot;</span>,</span>
<span id="cb4-8"><a href="#cb4-8"></a>              <span class="st">&quot;&gt; /workdir/marnin/beagle_GBS_october2016/CYCLE_NACRRI_june16/vcf/&quot;</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a>              <span class="st">&quot;Subset_cassavaGBSbuild_June2016_withRef_NACCRI_CYCLE_chr1.imputed.samples&quot;</span>))</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;bcftools query --list-samples /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageI_82819/&quot;</span>,</span>
<span id="cb4-11"><a href="#cb4-11"></a>              <span class="st">&quot;chr1_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb4-12"><a href="#cb4-12"></a>              <span class="st">&quot;&gt; /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageI_82819/&quot;</span>,</span>
<span id="cb4-13"><a href="#cb4-13"></a>              <span class="st">&quot;chr1_ImputationReferencePanel_StageIV_82819.samples&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>refpanelIV&lt;-<span class="kw">read.table</span>(<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageI_82819/&quot;</span>,</span>
<span id="cb5-2"><a href="#cb5-2"></a>                              <span class="st">&quot;chr1_ImputationReferencePanel_StageIV_82819.samples&quot;</span>),</span>
<span id="cb5-3"><a href="#cb5-3"></a>                       <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F)<span class="op">$</span>V1</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>ugC1&lt;-<span class="kw">read.table</span>(<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/beagle_GBS_october2016/CYCLE_NACRRI_june16/vcf/&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6"></a>                        <span class="st">&quot;Subset_cassavaGBSbuild_June2016_withRef_NACCRI_CYCLE_chr1.imputed.samples&quot;</span>),</span>
<span id="cb5-7"><a href="#cb5-7"></a>                 <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F)<span class="op">$</span>V1</span>
<span id="cb5-8"><a href="#cb5-8"></a>tzTP&lt;-<span class="kw">read.table</span>(<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/beagle_GBS_june17/TanzaniaData_20170601_withRef/&quot;</span>,</span>
<span id="cb5-9"><a href="#cb5-9"></a>                        <span class="st">&quot;TanzaniaData_20170601_withRef_chr1.filt2.imputed.samples&quot;</span>),</span>
<span id="cb5-10"><a href="#cb5-10"></a>                 <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F)<span class="op">$</span>V1</span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="kw">table</span>(ugC1 <span class="op">%in%</span><span class="st"> </span>tzTP) <span class="co"># false</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="kw">table</span>(ugC1 <span class="op">%in%</span><span class="st"> </span>refpanelIV)</span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co"># FALSE  TRUE </span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#  1915   175 </span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="kw">table</span>(tzTP <span class="op">%in%</span><span class="st"> </span>refpanelIV)</span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co"># FALSE  TRUE </span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#  1016   328 </span></span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a>gbsOnlySamplesToImpute&lt;-<span class="kw">union</span>(ugC1,tzTP) <span class="op">%&gt;%</span><span class="st"> </span>.[<span class="op">!</span>. <span class="op">%in%</span><span class="st"> </span>refpanelIV]</span>
<span id="cb5-20"><a href="#cb5-20"></a>gbsOnlySamplesToImpute_ugC1&lt;-ugC1 <span class="op">%&gt;%</span><span class="st"> </span>.[<span class="op">!</span>. <span class="op">%in%</span><span class="st"> </span>refpanelIV]</span>
<span id="cb5-21"><a href="#cb5-21"></a>gbsOnlySamplesToImpute_tzTP&lt;-tzTP <span class="op">%&gt;%</span><span class="st"> </span>.[<span class="op">!</span>. <span class="op">%in%</span><span class="st"> </span>refpanelIV]</span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="kw">write.table</span>(gbsOnlySamplesToImpute_ugC1,</span>
<span id="cb5-23"><a href="#cb5-23"></a>            <span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span>,</span>
<span id="cb5-24"><a href="#cb5-24"></a>                        <span class="st">&quot;gbsOnlySamplesToImpute_ugC1_90919.txt&quot;</span>),</span>
<span id="cb5-25"><a href="#cb5-25"></a>            <span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">quote =</span> F)</span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="kw">write.table</span>(gbsOnlySamplesToImpute_tzTP,</span>
<span id="cb5-27"><a href="#cb5-27"></a>            <span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span>,</span>
<span id="cb5-28"><a href="#cb5-28"></a>                        <span class="st">&quot;gbsOnlySamplesToImpute_tzTP_90919.txt&quot;</span>),</span>
<span id="cb5-29"><a href="#cb5-29"></a>            <span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">quote =</span> F)</span></code></pre></div>
</div>
<div id="sites" class="section level2">
<h2>Sites</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">library</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractSiteList=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;zcat /workdir/marnin/beagle_GBS_june17/TanzaniaData_20170601_withRef/&quot;</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>                  <span class="st">&quot;TanzaniaData_20170601_withRef_chr&quot;</span>,Chr,<span class="st">&quot;.filt2.imputed.vcf.gz &quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>                  <span class="st">&quot;| cut -f1-5 &gt; &quot;</span>,</span>
<span id="cb6-7"><a href="#cb6-7"></a>                  <span class="st">&quot;/workdir/marnin/beagle_GBS_june17/TanzaniaData_20170601_withRef/&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8"></a>                  <span class="st">&quot;TanzaniaData_20170601_withRef_chr&quot;</span>,Chr,<span class="st">&quot;.filt2.imputed.sitesWithAlleles&quot;</span>))}))</span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractSiteList=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb6-11"><a href="#cb6-11"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;zcat /workdir/marnin/beagle_GBS_october2016/CYCLE_NACRRI_june16/vcf/&quot;</span>,</span>
<span id="cb6-12"><a href="#cb6-12"></a>                  <span class="st">&quot;Subset_cassavaGBSbuild_June2016_withRef_NACCRI_CYCLE_chr&quot;</span>,Chr,<span class="st">&quot;.imputed.vcf.gz &quot;</span>,</span>
<span id="cb6-13"><a href="#cb6-13"></a>                  <span class="st">&quot;| cut -f1-5 &gt; &quot;</span>,</span>
<span id="cb6-14"><a href="#cb6-14"></a>                  <span class="st">&quot;/workdir/marnin/beagle_GBS_october2016/CYCLE_NACRRI_june16/vcf/&quot;</span>,</span>
<span id="cb6-15"><a href="#cb6-15"></a>                  <span class="st">&quot;Subset_cassavaGBSbuild_June2016_withRef_NACCRI_CYCLE_chr&quot;</span>,Chr,<span class="st">&quot;.imputed.sitesWithAlleles&quot;</span>))}))</span>
<span id="cb6-16"><a href="#cb6-16"></a></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractSiteList=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb6-19"><a href="#cb6-19"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;zcat /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb6-20"><a href="#cb6-20"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb6-21"><a href="#cb6-21"></a>                  <span class="st">&quot;| cut -f1-5 &gt; &quot;</span>,</span>
<span id="cb6-22"><a href="#cb6-22"></a>                  <span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb6-23"><a href="#cb6-23"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.sitesWithAlleles&quot;</span>))}))</span>
<span id="cb6-24"><a href="#cb6-24"></a></span>
<span id="cb6-25"><a href="#cb6-25"></a></span>
<span id="cb6-26"><a href="#cb6-26"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">GetINFO=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){ </span>
<span id="cb6-28"><a href="#cb6-28"></a>            fileIn&lt;-<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf /workdir/marnin/beagle_GBS_october2016/CYCLE_NACRRI_june16/vcf/&quot;</span>,</span>
<span id="cb6-29"><a href="#cb6-29"></a>                           <span class="st">&quot;Subset_cassavaGBSbuild_June2016_withRef_NACCRI_CYCLE_chr&quot;</span>,Chr,<span class="st">&quot;.imputed.vcf.gz &quot;</span>)</span>
<span id="cb6-30"><a href="#cb6-30"></a>            fileOut&lt;-<span class="kw">paste0</span>(<span class="st">&quot;--out /workdir/marnin/beagle_GBS_october2016/CYCLE_NACRRI_june16/vcf/&quot;</span>,</span>
<span id="cb6-31"><a href="#cb6-31"></a>                            <span class="st">&quot;Subset_cassavaGBSbuild_June2016_withRef_NACCRI_CYCLE_chr&quot;</span>,Chr,<span class="st">&quot;.imputed&quot;</span>)</span>
<span id="cb6-32"><a href="#cb6-32"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--get-INFO AR2 --get-INFO AF &quot;</span>,fileOut))</span>
<span id="cb6-33"><a href="#cb6-33"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--hardy &quot;</span>,fileOut)) }))</span>
<span id="cb6-34"><a href="#cb6-34"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-35"><a href="#cb6-35"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">GetINFO=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){ </span>
<span id="cb6-36"><a href="#cb6-36"></a>            fileIn&lt;-<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf /workdir/marnin/beagle_GBS_june17/TanzaniaData_20170601_withRef/&quot;</span>,</span>
<span id="cb6-37"><a href="#cb6-37"></a>                           <span class="st">&quot;TanzaniaData_20170601_withRef_chr&quot;</span>,Chr,<span class="st">&quot;.filt2.imputed.vcf.gz &quot;</span>)</span>
<span id="cb6-38"><a href="#cb6-38"></a>            fileOut&lt;-<span class="kw">paste0</span>(<span class="st">&quot;--out /workdir/marnin/beagle_GBS_june17/TanzaniaData_20170601_withRef/&quot;</span>,</span>
<span id="cb6-39"><a href="#cb6-39"></a>                            <span class="st">&quot;TanzaniaData_20170601_withRef_chr&quot;</span>,Chr,<span class="st">&quot;.filt2.imputed&quot;</span>)</span>
<span id="cb6-40"><a href="#cb6-40"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--get-INFO AR2 --get-INFO AF &quot;</span>,fileOut))</span>
<span id="cb6-41"><a href="#cb6-41"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--hardy &quot;</span>,fileOut)) }))</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>stats2filterOn_ugC1&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/beagle_GBS_october2016/CYCLE_NACRRI_june16/vcf/&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3"></a>                                                  <span class="st">&quot;Subset_cassavaGBSbuild_June2016_withRef_NACCRI_CYCLE_chr&quot;</span>,.,</span>
<span id="cb7-4"><a href="#cb7-4"></a>                                                  <span class="st">&quot;.imputed.INFO&quot;</span>), </span>
<span id="cb7-5"><a href="#cb7-5"></a>                                           <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)),</span>
<span id="cb7-6"><a href="#cb7-6"></a>           <span class="dt">hwe=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/beagle_GBS_october2016/CYCLE_NACRRI_june16/vcf/&quot;</span>,</span>
<span id="cb7-7"><a href="#cb7-7"></a>                                                 <span class="st">&quot;Subset_cassavaGBSbuild_June2016_withRef_NACCRI_CYCLE_chr&quot;</span>,.,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                                                 <span class="st">&quot;.imputed.hwe&quot;</span>), </span>
<span id="cb7-9"><a href="#cb7-9"></a>                                          <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)))</span>
<span id="cb7-10"><a href="#cb7-10"></a>stats2filterOn_ugC1 <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="st">  </span><span class="kw">select</span>(Chr,INFO,hwe) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map2</span>(INFO,hwe,<span class="op">~</span><span class="kw">left_join</span>(.x,(.y <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="st">                                             </span><span class="kw">rename</span>(<span class="dt">CHROM=</span>CHR))))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>hwe)</span>
<span id="cb7-15"><a href="#cb7-15"></a>stats2filterOn_ugC1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">NotNumDR2=</span><span class="kw">map_lgl</span>(INFO,<span class="op">~</span><span class="kw">is.numeric</span>(.<span class="op">$</span>DR2)))</span>
<span id="cb7-17"><a href="#cb7-17"></a>stats2filterOn_ugC1 <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,</span>
<span id="cb7-19"><a href="#cb7-19"></a>                  <span class="op">~</span><span class="kw">mutate</span>(.,</span>
<span id="cb7-20"><a href="#cb7-20"></a>                          <span class="dt">AR2=</span><span class="kw">as.numeric</span>(AR2),</span>
<span id="cb7-21"><a href="#cb7-21"></a>                          <span class="dt">AF=</span><span class="kw">as.numeric</span>(AF)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="st">                    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(AR2),</span>
<span id="cb7-23"><a href="#cb7-23"></a>                           <span class="op">!</span><span class="kw">is.na</span>(AF))))</span>
<span id="cb7-24"><a href="#cb7-24"></a>stats2filterOn_ugC1 <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,<span class="op">~</span><span class="kw">mutate</span>(.,<span class="dt">MAF=</span><span class="kw">ifelse</span>(AF<span class="op">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span><span class="op">-</span>AF,AF))))</span>
<span id="cb7-26"><a href="#cb7-26"></a>stats2filterOn_ugC1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>()</span></code></pre></div>
<p>Chr INFO NotNumDR2 <int> <list> <lgl><br />
1 1 &lt;data.frame [32,789 x 12]&gt; FALSE<br />
2 2 &lt;data.frame [25,770 x 12]&gt; FALSE<br />
3 3 &lt;data.frame [23,542 x 12]&gt; FALSE<br />
4 4 &lt;data.frame [19,718 x 12]&gt; FALSE<br />
5 5 &lt;data.frame [22,094 x 12]&gt; FALSE<br />
6 6 &lt;data.frame [21,505 x 12]&gt; FALSE<br />
7 7 &lt;data.frame [13,097 x 12]&gt; FALSE<br />
8 8 &lt;data.frame [19,177 x 12]&gt; FALSE<br />
9 9 &lt;data.frame [19,279 x 12]&gt; FALSE<br />
10 10 &lt;data.frame [16,185 x 12]&gt; FALSE<br />
11 11 &lt;data.frame [20,176 x 12]&gt; FALSE<br />
12 12 &lt;data.frame [16,877 x 12]&gt; FALSE<br />
13 13 &lt;data.frame [16,892 x 12]&gt; FALSE<br />
14 14 &lt;data.frame [22,189 x 12]&gt; FALSE<br />
15 15 &lt;data.frame [21,376 x 12]&gt; FALSE<br />
16 16 &lt;data.frame [16,423 x 12]&gt; FALSE<br />
17 17 &lt;data.frame [16,515 x 12]&gt; FALSE<br />
18 18 &lt;data.frame [16,188 x 12]&gt; FALSE</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>stats2filterOn_tzTP&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/beagle_GBS_june17/TanzaniaData_20170601_withRef/&quot;</span>,</span>
<span id="cb8-3"><a href="#cb8-3"></a>                                                  <span class="st">&quot;TanzaniaData_20170601_withRef_chr&quot;</span>,.,<span class="st">&quot;.filt2.imputed.INFO&quot;</span>), </span>
<span id="cb8-4"><a href="#cb8-4"></a>                                           <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)),</span>
<span id="cb8-5"><a href="#cb8-5"></a>           <span class="dt">hwe=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/beagle_GBS_june17/TanzaniaData_20170601_withRef/&quot;</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>                                                  <span class="st">&quot;TanzaniaData_20170601_withRef_chr&quot;</span>,.,<span class="st">&quot;.filt2.imputed.hwe&quot;</span>), </span>
<span id="cb8-7"><a href="#cb8-7"></a>                                          <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)))</span>
<span id="cb8-8"><a href="#cb8-8"></a>stats2filterOn_tzTP <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="st">  </span><span class="kw">select</span>(Chr,INFO,hwe) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map2</span>(INFO,hwe,<span class="op">~</span><span class="kw">left_join</span>(.x,(.y <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="st">                                             </span><span class="kw">rename</span>(<span class="dt">CHROM=</span>CHR))))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>hwe)</span>
<span id="cb8-13"><a href="#cb8-13"></a>stats2filterOn_tzTP <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">NotNumDR2=</span><span class="kw">map_lgl</span>(INFO,<span class="op">~</span><span class="kw">is.numeric</span>(.<span class="op">$</span>DR2)))</span>
<span id="cb8-15"><a href="#cb8-15"></a>stats2filterOn_tzTP <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,</span>
<span id="cb8-17"><a href="#cb8-17"></a>                  <span class="op">~</span><span class="kw">mutate</span>(.,</span>
<span id="cb8-18"><a href="#cb8-18"></a>                          <span class="dt">AR2=</span><span class="kw">as.numeric</span>(AR2),</span>
<span id="cb8-19"><a href="#cb8-19"></a>                          <span class="dt">AF=</span><span class="kw">as.numeric</span>(AF)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="st">                    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(AR2),</span>
<span id="cb8-21"><a href="#cb8-21"></a>                           <span class="op">!</span><span class="kw">is.na</span>(AF))))</span>
<span id="cb8-22"><a href="#cb8-22"></a>stats2filterOn_tzTP <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,<span class="op">~</span><span class="kw">mutate</span>(.,<span class="dt">MAF=</span><span class="kw">ifelse</span>(AF<span class="op">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span><span class="op">-</span>AF,AF))))</span>
<span id="cb8-24"><a href="#cb8-24"></a>stats2filterOn_tzTP <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>()</span></code></pre></div>
<p>Chr INFO NotNumDR2 <int> <list> <lgl><br />
1 1 &lt;data.frame [32,789 x 12]&gt; FALSE<br />
2 2 &lt;data.frame [25,770 x 12]&gt; FALSE<br />
3 3 &lt;data.frame [23,542 x 12]&gt; FALSE<br />
4 4 &lt;data.frame [19,718 x 12]&gt; FALSE<br />
5 5 &lt;data.frame [22,094 x 12]&gt; FALSE<br />
6 6 &lt;data.frame [21,505 x 12]&gt; FALSE<br />
7 7 &lt;data.frame [13,097 x 12]&gt; FALSE<br />
8 8 &lt;data.frame [19,177 x 12]&gt; FALSE<br />
9 9 &lt;data.frame [19,279 x 12]&gt; FALSE<br />
10 10 &lt;data.frame [16,185 x 12]&gt; FALSE<br />
11 11 &lt;data.frame [20,176 x 12]&gt; FALSE<br />
12 12 &lt;data.frame [16,877 x 12]&gt; FALSE<br />
13 13 &lt;data.frame [16,892 x 12]&gt; FALSE<br />
14 14 &lt;data.frame [22,189 x 12]&gt; FALSE<br />
15 15 &lt;data.frame [21,376 x 12]&gt; FALSE<br />
16 16 &lt;data.frame [16,423 x 12]&gt; FALSE<br />
17 17 &lt;data.frame [16,515 x 12]&gt; FALSE<br />
18 18 &lt;data.frame [16,188 x 12]&gt; FALSE</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>refpanelIV_sites&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">SiteList=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){ </span>
<span id="cb9-3"><a href="#cb9-3"></a>    refpanel4&lt;-<span class="kw">read.table</span>(<span class="dt">file =</span> <span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb9-4"><a href="#cb9-4"></a>                                        Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.sitesWithAlleles&quot;</span>),</span>
<span id="cb9-5"><a href="#cb9-5"></a>                          <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F) </span>
<span id="cb9-6"><a href="#cb9-6"></a>    <span class="kw">return</span>(refpanel4)})) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">CHROM=</span>V1,</span>
<span id="cb9-9"><a href="#cb9-9"></a>         <span class="dt">POS=</span>V2,</span>
<span id="cb9-10"><a href="#cb9-10"></a>         <span class="dt">ID=</span>V3,</span>
<span id="cb9-11"><a href="#cb9-11"></a>         <span class="dt">REF=</span>V4,</span>
<span id="cb9-12"><a href="#cb9-12"></a>         <span class="dt">ALT=</span>V5)</span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="kw">dim</span>(refpanelIV_sites) <span class="co"># [1] 65509     6</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="kw">head</span>(refpanelIV_sites)</span></code></pre></div>
<p>After poor results on 9/09/19, this time, I want to treat tzTP and ugC1 separately, with emphasis on ugC1…</p>
<p>Keep sites that have: 1. Matching chrom, pos and alleles in <em>both</em> imputed GBS datasets (<em>ugC1</em> and <em>tzTP</em>), 2. Passing pre-imputation filters in the GBS datasets (<em>ugC1</em> and <em>tzTP</em>) + AR2&gt;0.75, P_HWE&gt;1e-20, MAF&gt;0.005 [0.5%] 3. Intersect the <em>refpanelIV</em> sitesWithAlleles</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>stats2filterOn_tzTP <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">allSitesPassing=</span><span class="kw">map</span>(INFO,</span>
<span id="cb10-3"><a href="#cb10-3"></a>                             <span class="op">~</span><span class="kw">filter</span>(.,AR2<span class="op">&gt;=</span><span class="fl">0.75</span>,</span>
<span id="cb10-4"><a href="#cb10-4"></a>                                     P_HWE<span class="op">&gt;</span><span class="fl">1e-20</span>,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                                     MAF<span class="op">&gt;</span><span class="fl">0.005</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="st">                               </span><span class="kw">select</span>(CHROM,POS,REF,ALT)))</span>
<span id="cb10-7"><a href="#cb10-7"></a>stats2filterOn_ugC1 <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">allSitesPassing=</span><span class="kw">map</span>(INFO,</span>
<span id="cb10-9"><a href="#cb10-9"></a>                             <span class="op">~</span><span class="kw">filter</span>(.,AR2<span class="op">&gt;=</span><span class="fl">0.75</span>,</span>
<span id="cb10-10"><a href="#cb10-10"></a>                                     P_HWE<span class="op">&gt;</span><span class="fl">1e-20</span>,</span>
<span id="cb10-11"><a href="#cb10-11"></a>                                     MAF<span class="op">&gt;</span><span class="fl">0.005</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="st">                               </span><span class="kw">select</span>(CHROM,POS,REF,ALT)))</span>
<span id="cb10-13"><a href="#cb10-13"></a></span>
<span id="cb10-14"><a href="#cb10-14"></a>sitesPassingFilters_tzTP&lt;-stats2filterOn_tzTP <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="st">  </span><span class="kw">unnest</span>(allSitesPassing) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="st">  </span><span class="kw">semi_join</span>(refpanelIV_sites) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="st">  </span><span class="kw">group_by</span>(Chr) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="st">  </span><span class="kw">nest</span>(<span class="dt">.key =</span> <span class="st">&quot;allSitesPassing&quot;</span>)</span>
<span id="cb10-19"><a href="#cb10-19"></a>sitesPassingFilters_ugC1&lt;-stats2filterOn_ugC1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="st">  </span><span class="kw">unnest</span>(allSitesPassing) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="st">  </span><span class="kw">semi_join</span>(refpanelIV_sites) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="st">  </span><span class="kw">group_by</span>(Chr) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="st">  </span><span class="kw">nest</span>(<span class="dt">.key =</span> <span class="st">&quot;allSitesPassing&quot;</span>)</span>
<span id="cb10-24"><a href="#cb10-24"></a>sitesPassingFilters_tzTP <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 48996</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>sitesPassingFilters_ugC1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 8170</span></span>
<span id="cb10-26"><a href="#cb10-26"></a>sitesPassingFilters_tzTP</span>
<span id="cb10-27"><a href="#cb10-27"></a>sitesPassingFilters_ugC1</span></code></pre></div>
<pre><code> Chr allSitesPassing     </code></pre>
<p><int> <list><br />
1 1 &lt;tibble [5,985 x 4]&gt; 2 2 &lt;tibble [2,980 x 4]&gt; 3 3 &lt;tibble [3,144 x 4]&gt; 4 4 &lt;tibble [2,860 x 4]&gt; 5 5 &lt;tibble [2,781 x 4]&gt; 6 6 &lt;tibble [2,794 x 4]&gt; 7 7 &lt;tibble [1,476 x 4]&gt; 8 8 &lt;tibble [2,767 x 4]&gt; 9 9 &lt;tibble [2,492 x 4]&gt; 10 10 &lt;tibble [2,218 x 4]&gt; 11 11 &lt;tibble [2,421 x 4]&gt; 12 12 &lt;tibble [2,108 x 4]&gt; 13 13 &lt;tibble [2,079 x 4]&gt; 14 14 &lt;tibble [3,290 x 4]&gt; 15 15 &lt;tibble [2,933 x 4]&gt; 16 16 &lt;tibble [2,135 x 4]&gt; 17 17 &lt;tibble [2,109 x 4]&gt; 18 18 &lt;tibble [2,424 x 4]&gt; Chr allSitesPassing<br />
<int> <list><br />
1 1 &lt;tibble [2,985 x 4]&gt; 2 2 &lt;tibble [332 x 4]&gt;<br />
3 3 &lt;tibble [372 x 4]&gt;<br />
4 4 &lt;tibble [597 x 4]&gt;<br />
5 5 &lt;tibble [322 x 4]&gt;<br />
6 6 &lt;tibble [321 x 4]&gt;<br />
7 7 &lt;tibble [204 x 4]&gt;<br />
8 8 &lt;tibble [152 x 4]&gt;<br />
9 9 &lt;tibble [376 x 4]&gt;<br />
10 10 &lt;tibble [186 x 4]&gt;<br />
11 11 &lt;tibble [301 x 4]&gt;<br />
12 12 &lt;tibble [187 x 4]&gt;<br />
13 13 &lt;tibble [263 x 4]&gt;<br />
14 14 &lt;tibble [326 x 4]&gt;<br />
15 15 &lt;tibble [242 x 4]&gt;<br />
16 16 &lt;tibble [263 x 4]&gt;<br />
17 17 &lt;tibble [486 x 4]&gt;<br />
18 18 &lt;tibble [255 x 4]&gt;</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>sitesPassingFilters_ugC1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">WriteSiteList=</span><span class="kw">future_map2</span>(Chr,allSitesPassing,<span class="cf">function</span>(Chr,allSitesPassing){ </span>
<span id="cb12-3"><a href="#cb12-3"></a>        pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>        <span class="co">#pathIn&lt;-&quot;/workdir/mw489/ImputationEastAfrica_StageI_82819/&quot;</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>        sitesPassing_thisChr&lt;-allSitesPassing <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="st">          </span><span class="kw">select</span>(CHROM,POS) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="st">          </span><span class="kw">arrange</span>(CHROM,POS)</span>
<span id="cb12-8"><a href="#cb12-8"></a>        <span class="kw">write.table</span>(sitesPassing_thisChr,</span>
<span id="cb12-9"><a href="#cb12-9"></a>                    <span class="dt">file =</span> <span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb12-10"><a href="#cb12-10"></a>                                  <span class="st">&quot;_ugC1_ImputedGBS_91019.sitesPassing&quot;</span>),</span>
<span id="cb12-11"><a href="#cb12-11"></a>                    <span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">quote =</span> F)}))</span>
<span id="cb12-12"><a href="#cb12-12"></a>sitesPassingFilters_tzTP <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">WriteSiteList=</span><span class="kw">future_map2</span>(Chr,allSitesPassing,<span class="cf">function</span>(Chr,allSitesPassing){ </span>
<span id="cb12-14"><a href="#cb12-14"></a>        pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>        <span class="co">#pathIn&lt;-&quot;/workdir/mw489/ImputationEastAfrica_StageI_82819/&quot;</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>        sitesPassing_thisChr&lt;-allSitesPassing <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="st">          </span><span class="kw">select</span>(CHROM,POS) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="st">          </span><span class="kw">arrange</span>(CHROM,POS)</span>
<span id="cb12-19"><a href="#cb12-19"></a>        <span class="kw">write.table</span>(sitesPassing_thisChr,</span>
<span id="cb12-20"><a href="#cb12-20"></a>                    <span class="dt">file =</span> <span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb12-21"><a href="#cb12-21"></a>                                  <span class="st">&quot;_tzTP_ImputedGBS_91019.sitesPassing&quot;</span>),</span>
<span id="cb12-22"><a href="#cb12-22"></a>                    <span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">quote =</span> F)}))</span></code></pre></div>
</div>
<div id="extract-refimputed-data-tztp" class="section level2">
<h2>Extract REFimputed data tzTP</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">require</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractRaw_gbsSamples=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf /workdir/marnin/beagle_GBS_june17/TanzaniaData_20170601_withRef/&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>                  <span class="st">&quot;TanzaniaData_20170601_withRef_chr&quot;</span>,Chr,<span class="st">&quot;.filt2.imputed.vcf.gz &quot;</span>,</span>
<span id="cb13-6"><a href="#cb13-6"></a>                  <span class="st">&quot;--keep /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span>,</span>
<span id="cb13-7"><a href="#cb13-7"></a>                  <span class="st">&quot;gbsOnlySamplesToImpute_tzTP_90919.txt &quot;</span>,</span>
<span id="cb13-8"><a href="#cb13-8"></a>                  <span class="st">&quot;--chr &quot;</span>,Chr,<span class="st">&quot; &quot;</span>,</span>
<span id="cb13-9"><a href="#cb13-9"></a>                  <span class="st">&quot;--positions /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb13-10"><a href="#cb13-10"></a>                  Chr,<span class="st">&quot;_tzTP_ImputedGBS_91019.sitesPassing &quot;</span>,</span>
<span id="cb13-11"><a href="#cb13-11"></a>                  <span class="st">&quot;--recode &quot;</span>,</span>
<span id="cb13-12"><a href="#cb13-12"></a>                  <span class="st">&quot;--stdout | bgzip -c -@ 24 &gt; &quot;</span>,</span>
<span id="cb13-13"><a href="#cb13-13"></a>                  <span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb13-14"><a href="#cb13-14"></a>                  Chr,<span class="st">&quot;_tzTPsamples_REFimputedGBSsites_91019.vcf.gz&quot;</span>)) }))</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Index=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){ </span>
<span id="cb14-3"><a href="#cb14-3"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;tabix -f -p vcf /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb14-4"><a href="#cb14-4"></a>                  Chr,<span class="st">&quot;_tzTPsamples_REFimputedGBSsites_91019.vcf.gz&quot;</span>))</span>
<span id="cb14-5"><a href="#cb14-5"></a>    }))</span></code></pre></div>
</div>
<div id="extract-refimputed-data-ugc1" class="section level2">
<h2>Extract REFimputed data ugC1</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">require</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractRaw_gbsSamples=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf /workdir/marnin/beagle_GBS_october2016/CYCLE_NACRRI_june16/vcf/&quot;</span>,</span>
<span id="cb15-5"><a href="#cb15-5"></a>                  <span class="st">&quot;Subset_cassavaGBSbuild_June2016_withRef_NACCRI_CYCLE_chr&quot;</span>,Chr,<span class="st">&quot;.imputed.vcf.gz &quot;</span>,</span>
<span id="cb15-6"><a href="#cb15-6"></a>                  <span class="st">&quot;--keep /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>                  <span class="st">&quot;gbsOnlySamplesToImpute_ugC1_90919.txt &quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8"></a>                  <span class="st">&quot;--chr &quot;</span>,Chr,<span class="st">&quot; &quot;</span>,</span>
<span id="cb15-9"><a href="#cb15-9"></a>                  <span class="st">&quot;--positions /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb15-10"><a href="#cb15-10"></a>                  Chr,<span class="st">&quot;_ugC1_ImputedGBS_91019.sitesPassing &quot;</span>,</span>
<span id="cb15-11"><a href="#cb15-11"></a>                  <span class="st">&quot;--recode &quot;</span>,</span>
<span id="cb15-12"><a href="#cb15-12"></a>                  <span class="st">&quot;--stdout | bgzip -c -@ 24 &gt; &quot;</span>,</span>
<span id="cb15-13"><a href="#cb15-13"></a>                  <span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb15-14"><a href="#cb15-14"></a>                  Chr,<span class="st">&quot;_ugC1samples_REFimputedGBSsites_91019.vcf.gz&quot;</span>)) }))</span>
<span id="cb15-15"><a href="#cb15-15"></a></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Index=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){ </span>
<span id="cb15-18"><a href="#cb15-18"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;tabix -f -p vcf /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb15-19"><a href="#cb15-19"></a>                  Chr,<span class="st">&quot;_ugC1samples_REFimputedGBSsites_91019.vcf.gz&quot;</span>))</span>
<span id="cb15-20"><a href="#cb15-20"></a>    }))</span></code></pre></div>
</div>
<div id="rsync" class="section level2">
<h2>Rsync</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># cbsulm__ --&gt; cbsurobbins</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span></span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co"># cbsurobbins --&gt; cbsulm__</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm17.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span>;</span>
<span id="cb16-7"><a href="#cb16-7"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm16.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span>;</span>
<span id="cb16-8"><a href="#cb16-8"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm14.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span>;</span>
<span id="cb16-9"><a href="#cb16-9"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm13.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span>;</span>
<span id="cb16-10"><a href="#cb16-10"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm12.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span>;</span>
<span id="cb16-11"><a href="#cb16-11"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm07.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span>;</span>
<span id="cb16-12"><a href="#cb16-12"></a></span>
<span id="cb16-13"><a href="#cb16-13"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm17.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb16-14"><a href="#cb16-14"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm16.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb16-15"><a href="#cb16-15"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm14.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb16-16"><a href="#cb16-16"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm13.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb16-17"><a href="#cb16-17"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm12.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb16-18"><a href="#cb16-18"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm07.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span></code></pre></div>
</div>
</div>
<div id="impute-tztp-samples-ungenotyped-sites-ref-impute-gt-mode-beagle-5.0" class="section level1">
<h1>Impute tzTP samples @ ungenotyped sites (REF impute, GT mode, Beagle 5.0)</h1>
<div id="cbsulm17-112-1235" class="section level2">
<h2>cbsulm17 (112) [1,2,3,5]</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_UnGenotypedSites_GBSonlySamples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb17-4"><a href="#cb17-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb17-6"><a href="#cb17-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb17-7"><a href="#cb17-7"></a>                  Chr,<span class="st">&quot;_tzTPsamples_REFimputedGBSsites_91019.vcf.gz &quot;</span>,</span>
<span id="cb17-8"><a href="#cb17-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb17-9"><a href="#cb17-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb17-10"><a href="#cb17-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb17-11"><a href="#cb17-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb17-12"><a href="#cb17-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb17-13"><a href="#cb17-13"></a>                  Chr,<span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019 &quot;</span>,</span>
<span id="cb17-14"><a href="#cb17-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="cbsulm16-112-4678" class="section level2">
<h2>cbsulm16 (112) [4,6,7,8]</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_UnGenotypedSites_GBSonlySamples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb18-4"><a href="#cb18-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb18-6"><a href="#cb18-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb18-7"><a href="#cb18-7"></a>                  Chr,<span class="st">&quot;_tzTPsamples_REFimputedGBSsites_91019.vcf.gz &quot;</span>,</span>
<span id="cb18-8"><a href="#cb18-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb18-9"><a href="#cb18-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb18-10"><a href="#cb18-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb18-11"><a href="#cb18-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb18-12"><a href="#cb18-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb18-13"><a href="#cb18-13"></a>                  Chr,<span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019 &quot;</span>,</span>
<span id="cb18-14"><a href="#cb18-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="cbsulm14-112-9101112" class="section level2">
<h2>cbsulm14 (112) [9,10,11,12]</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_UnGenotypedSites_GBSonlySamples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb19-4"><a href="#cb19-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb19-6"><a href="#cb19-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb19-7"><a href="#cb19-7"></a>                  Chr,<span class="st">&quot;_tzTPsamples_REFimputedGBSsites_91019.vcf.gz &quot;</span>,</span>
<span id="cb19-8"><a href="#cb19-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb19-9"><a href="#cb19-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb19-10"><a href="#cb19-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb19-11"><a href="#cb19-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb19-12"><a href="#cb19-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb19-13"><a href="#cb19-13"></a>                  Chr,<span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019 &quot;</span>,</span>
<span id="cb19-14"><a href="#cb19-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="cbsulm13-96-131415" class="section level2">
<h2>cbsulm13 (96) [13,14,15]</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_UnGenotypedSites_GBSonlySamples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb20-4"><a href="#cb20-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb20-6"><a href="#cb20-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb20-7"><a href="#cb20-7"></a>                  Chr,<span class="st">&quot;_tzTPsamples_REFimputedGBSsites_91019.vcf.gz &quot;</span>,</span>
<span id="cb20-8"><a href="#cb20-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb20-9"><a href="#cb20-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb20-10"><a href="#cb20-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb20-11"><a href="#cb20-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb20-12"><a href="#cb20-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb20-13"><a href="#cb20-13"></a>                  Chr,<span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019 &quot;</span>,</span>
<span id="cb20-14"><a href="#cb20-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="cbsulm12-96-161718" class="section level2">
<h2>cbsulm12 (96) [16,17,18]</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_UnGenotypedSites_GBSonlySamples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb21-4"><a href="#cb21-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb21-6"><a href="#cb21-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb21-7"><a href="#cb21-7"></a>                  Chr,<span class="st">&quot;_tzTPsamples_REFimputedGBSsites_91019.vcf.gz &quot;</span>,</span>
<span id="cb21-8"><a href="#cb21-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb21-9"><a href="#cb21-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb21-10"><a href="#cb21-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb21-11"><a href="#cb21-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb21-12"><a href="#cb21-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb21-13"><a href="#cb21-13"></a>                  Chr,<span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019 &quot;</span>,</span>
<span id="cb21-14"><a href="#cb21-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="beaglelogs" class="section level2">
<h2>BeagleLogs</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>cd <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>; </span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co">#mkdir BeagleLogs;</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>cp <span class="op">*</span>_tzTPsamples_AllSitesREFimputedAndPhased_<span class="fl">91019.</span>log BeagleLogs<span class="op">/</span></span></code></pre></div>
</div>
<div id="rsync-1" class="section level2">
<h2>Rsync</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># cbsulm__ --&gt; cbsurobbins</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span></span></code></pre></div>
</div>
<div id="post-impute-filter" class="section level2">
<h2>Post-impute filter</h2>
<p>AR2&gt;0.75, P_HWE&gt;1e-20, MAF&gt;0.005 [0.5%]</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">library</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb24-2"><a href="#cb24-2"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PostImputeFilter=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){ </span>
<span id="cb24-5"><a href="#cb24-5"></a>            fileIn&lt;-<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,</span>
<span id="cb24-6"><a href="#cb24-6"></a>                           Chr,<span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019.vcf.gz &quot;</span>)</span>
<span id="cb24-7"><a href="#cb24-7"></a>            fileOut&lt;-<span class="kw">paste0</span>(<span class="st">&quot;--out &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,</span>
<span id="cb24-8"><a href="#cb24-8"></a>                            Chr,<span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019&quot;</span>)</span>
<span id="cb24-9"><a href="#cb24-9"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--get-INFO DR2 --get-INFO AF &quot;</span>,fileOut))</span>
<span id="cb24-10"><a href="#cb24-10"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--hardy &quot;</span>,fileOut)) }))</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>stats2filterOn&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb25-4"><a href="#cb25-4"></a>                                                <span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019.INFO&quot;</span>), </span>
<span id="cb25-5"><a href="#cb25-5"></a>                                         <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)),</span>
<span id="cb25-6"><a href="#cb25-6"></a>         <span class="dt">hwe=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb25-7"><a href="#cb25-7"></a>                                               <span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019.hwe&quot;</span>), </span>
<span id="cb25-8"><a href="#cb25-8"></a>                                        <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)))</span>
<span id="cb25-9"><a href="#cb25-9"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="st">  </span><span class="kw">select</span>(Chr,INFO,hwe) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map2</span>(INFO,hwe,<span class="op">~</span><span class="kw">left_join</span>(.x,(.y <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="st">                                             </span><span class="kw">rename</span>(<span class="dt">CHROM=</span>CHR))))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>hwe)</span>
<span id="cb25-14"><a href="#cb25-14"></a>stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-15"><a href="#cb25-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">NotNumDR2=</span><span class="kw">map_lgl</span>(INFO,<span class="op">~</span><span class="kw">is.numeric</span>(.<span class="op">$</span>DR2)))</span>
<span id="cb25-16"><a href="#cb25-16"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb25-17"><a href="#cb25-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,</span>
<span id="cb25-18"><a href="#cb25-18"></a>                  <span class="op">~</span><span class="kw">mutate</span>(.,</span>
<span id="cb25-19"><a href="#cb25-19"></a>                          <span class="dt">DR2=</span><span class="kw">as.numeric</span>(DR2),</span>
<span id="cb25-20"><a href="#cb25-20"></a>                          <span class="dt">AF=</span><span class="kw">as.numeric</span>(AF)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-21"><a href="#cb25-21"></a><span class="st">                    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(DR2),</span>
<span id="cb25-22"><a href="#cb25-22"></a>                           <span class="op">!</span><span class="kw">is.na</span>(AF))))</span>
<span id="cb25-23"><a href="#cb25-23"></a></span>
<span id="cb25-24"><a href="#cb25-24"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb25-25"><a href="#cb25-25"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,<span class="op">~</span><span class="kw">mutate</span>(.,<span class="dt">MAF=</span><span class="kw">ifelse</span>(AF<span class="op">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span><span class="op">-</span>AF,AF))))</span></code></pre></div>
<p>Check what’s left</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>sitesPassingFilters&lt;-stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">allSitesPassing=</span><span class="kw">map</span>(INFO,</span>
<span id="cb26-3"><a href="#cb26-3"></a>                             <span class="op">~</span><span class="kw">filter</span>(.,DR2<span class="op">&gt;=</span><span class="fl">0.75</span>,</span>
<span id="cb26-4"><a href="#cb26-4"></a>                                     P_HWE<span class="op">&gt;</span><span class="fl">1e-20</span>,</span>
<span id="cb26-5"><a href="#cb26-5"></a>                                     MAF<span class="op">&gt;</span><span class="fl">0.005</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="st">                               </span><span class="kw">select</span>(CHROM,POS))) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>INFO)</span>
<span id="cb26-8"><a href="#cb26-8"></a>stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 65451</span></span>
<span id="cb26-9"><a href="#cb26-9"></a>sitesPassingFilters <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(allSitesPassing) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 65130</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>stats2filterOn</span>
<span id="cb26-11"><a href="#cb26-11"></a>sitesPassingFilters</span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co">#         Chr allSitesPassing         </span></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co">#    &lt;int&gt; &lt;list&gt;                  </span></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="co">#  1     1 &lt;data.frame [8,201 x 2]&gt;</span></span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">#  2     2 &lt;data.frame [3,854 x 2]&gt;</span></span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="co">#  3     3 &lt;data.frame [4,102 x 2]&gt;</span></span>
<span id="cb26-17"><a href="#cb26-17"></a><span class="co">#  4     4 &lt;data.frame [3,773 x 2]&gt;</span></span>
<span id="cb26-18"><a href="#cb26-18"></a><span class="co">#  5     5 &lt;data.frame [3,807 x 2]&gt;</span></span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="co">#  6     6 &lt;data.frame [3,594 x 2]&gt;</span></span>
<span id="cb26-20"><a href="#cb26-20"></a><span class="co">#  7     7 &lt;data.frame [1,959 x 2]&gt;</span></span>
<span id="cb26-21"><a href="#cb26-21"></a><span class="co">#  8     8 &lt;data.frame [3,628 x 2]&gt;</span></span>
<span id="cb26-22"><a href="#cb26-22"></a><span class="co">#  9     9 &lt;data.frame [3,449 x 2]&gt;</span></span>
<span id="cb26-23"><a href="#cb26-23"></a><span class="co"># 10    10 &lt;data.frame [2,901 x 2]&gt;</span></span>
<span id="cb26-24"><a href="#cb26-24"></a><span class="co"># 11    11 &lt;data.frame [3,297 x 2]&gt;</span></span>
<span id="cb26-25"><a href="#cb26-25"></a><span class="co"># 12    12 &lt;data.frame [2,893 x 2]&gt;</span></span>
<span id="cb26-26"><a href="#cb26-26"></a><span class="co"># 13    13 &lt;data.frame [2,773 x 2]&gt;</span></span>
<span id="cb26-27"><a href="#cb26-27"></a><span class="co"># 14    14 &lt;data.frame [4,172 x 2]&gt;</span></span>
<span id="cb26-28"><a href="#cb26-28"></a><span class="co"># 15    15 &lt;data.frame [3,959 x 2]&gt;</span></span>
<span id="cb26-29"><a href="#cb26-29"></a><span class="co"># 16    16 &lt;data.frame [2,875 x 2]&gt;</span></span>
<span id="cb26-30"><a href="#cb26-30"></a><span class="co"># 17    17 &lt;data.frame [2,775 x 2]&gt;</span></span>
<span id="cb26-31"><a href="#cb26-31"></a><span class="co"># 18    18 &lt;data.frame [3,118 x 2]&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>sitesPassingFilters <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">PostImputePrePhaseFilter=</span><span class="kw">future_map2</span>(Chr,allSitesPassing,<span class="cf">function</span>(Chr,allSitesPassing){ </span>
<span id="cb27-3"><a href="#cb27-3"></a>        pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>        sitesPassing_thisChr&lt;-allSitesPassing <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="st">          </span><span class="kw">select</span>(CHROM,POS)</span>
<span id="cb27-6"><a href="#cb27-6"></a>        <span class="kw">write.table</span>(sitesPassing_thisChr,</span>
<span id="cb27-7"><a href="#cb27-7"></a>                    <span class="dt">file =</span> <span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb27-8"><a href="#cb27-8"></a>                                  <span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019.sitesPassing&quot;</span>),</span>
<span id="cb27-9"><a href="#cb27-9"></a>                    <span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">quote =</span> F)}))</span>
<span id="cb27-10"><a href="#cb27-10"></a>sitesPassingFilters <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">PostImputePrePhaseFilter=</span><span class="kw">future_map2</span>(Chr,allSitesPassing,<span class="cf">function</span>(Chr,allSitesPassing){ </span>
<span id="cb27-12"><a href="#cb27-12"></a>        pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb27-13"><a href="#cb27-13"></a>        <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb27-14"><a href="#cb27-14"></a>                      <span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019.vcf.gz &quot;</span>,</span>
<span id="cb27-15"><a href="#cb27-15"></a>                      <span class="st">&quot;--positions &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb27-16"><a href="#cb27-16"></a>                      <span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019.sitesPassing &quot;</span>,</span>
<span id="cb27-17"><a href="#cb27-17"></a>                      <span class="st">&quot;--recode --stdout | &quot;</span>,</span>
<span id="cb27-18"><a href="#cb27-18"></a>                      <span class="st">&quot;bgzip -c -@ 24 &gt; &quot;</span>,</span>
<span id="cb27-19"><a href="#cb27-19"></a>                      pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb27-20"><a href="#cb27-20"></a>                      <span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_ReadyToMergeWithRefPanel_91019.vcf.gz&quot;</span>))}))</span>
<span id="cb27-21"><a href="#cb27-21"></a></span>
<span id="cb27-22"><a href="#cb27-22"></a><span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;bcftools query --list-samples /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span>,</span>
<span id="cb27-23"><a href="#cb27-23"></a>              <span class="st">&quot;chr1_tzTPsamples_AllSitesREFimputedAndPhased_ReadyToMergeWithRefPanel_91019.vcf.gz &quot;</span>,</span>
<span id="cb27-24"><a href="#cb27-24"></a>              <span class="st">&quot;&gt; /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span>,</span>
<span id="cb27-25"><a href="#cb27-25"></a>              <span class="st">&quot;chr1_tzTPsamples_AllSitesREFimputedAndPhased_ReadyToMergeWithRefPanel_91019.samples&quot;</span>))</span></code></pre></div>
</div>
</div>
<div id="impute-ugc1-samples-ungenotyped-sites-ref-impute-gt-mode-beagle-5.0" class="section level1">
<h1>Impute ugC1 samples @ ungenotyped sites (REF impute, GT mode, Beagle 5.0)</h1>
<div id="cbsulm17-112-1235-1" class="section level2">
<h2>cbsulm17 (112) [1,2,3,5]</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_UnGenotypedSites_GBSonlySamples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb28-4"><a href="#cb28-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb28-6"><a href="#cb28-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb28-7"><a href="#cb28-7"></a>                  Chr,<span class="st">&quot;_ugC1samples_REFimputedGBSsites_91019.vcf.gz &quot;</span>,</span>
<span id="cb28-8"><a href="#cb28-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb28-9"><a href="#cb28-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb28-10"><a href="#cb28-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb28-11"><a href="#cb28-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb28-12"><a href="#cb28-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb28-13"><a href="#cb28-13"></a>                  Chr,<span class="st">&quot;_ugC1samples_AllSitesREFimputedAndPhased_91019 &quot;</span>,</span>
<span id="cb28-14"><a href="#cb28-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="cbsulm16-112-4678-1" class="section level2">
<h2>cbsulm16 (112) [4,6,7,8]</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_UnGenotypedSites_GBSonlySamples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb29-4"><a href="#cb29-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb29-6"><a href="#cb29-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb29-7"><a href="#cb29-7"></a>                  Chr,<span class="st">&quot;_ugC1samples_REFimputedGBSsites_91019.vcf.gz &quot;</span>,</span>
<span id="cb29-8"><a href="#cb29-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb29-9"><a href="#cb29-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb29-10"><a href="#cb29-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb29-11"><a href="#cb29-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb29-12"><a href="#cb29-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb29-13"><a href="#cb29-13"></a>                  Chr,<span class="st">&quot;_ugC1samples_AllSitesREFimputedAndPhased_91019 &quot;</span>,</span>
<span id="cb29-14"><a href="#cb29-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="cbsulm14-112-9101112-1" class="section level2">
<h2>cbsulm14 (112) [9,10,11,12]</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_UnGenotypedSites_GBSonlySamples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb30-4"><a href="#cb30-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb30-6"><a href="#cb30-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb30-7"><a href="#cb30-7"></a>                  Chr,<span class="st">&quot;_ugC1samples_REFimputedGBSsites_91019.vcf.gz &quot;</span>,</span>
<span id="cb30-8"><a href="#cb30-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb30-9"><a href="#cb30-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb30-10"><a href="#cb30-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb30-11"><a href="#cb30-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb30-12"><a href="#cb30-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb30-13"><a href="#cb30-13"></a>                  Chr,<span class="st">&quot;_ugC1samples_AllSitesREFimputedAndPhased_91019 &quot;</span>,</span>
<span id="cb30-14"><a href="#cb30-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="cbsulm13-96-131415-1" class="section level2">
<h2>cbsulm13 (96) [13,14,15]</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_UnGenotypedSites_GBSonlySamples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb31-4"><a href="#cb31-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb31-6"><a href="#cb31-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb31-7"><a href="#cb31-7"></a>                  Chr,<span class="st">&quot;_ugC1samples_REFimputedGBSsites_91019.vcf.gz &quot;</span>,</span>
<span id="cb31-8"><a href="#cb31-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb31-9"><a href="#cb31-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb31-10"><a href="#cb31-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb31-11"><a href="#cb31-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb31-12"><a href="#cb31-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb31-13"><a href="#cb31-13"></a>                  Chr,<span class="st">&quot;_ugC1samples_AllSitesREFimputedAndPhased_91019 &quot;</span>,</span>
<span id="cb31-14"><a href="#cb31-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="cbsulm12-96-161718-1" class="section level2">
<h2>cbsulm12 (96) [16,17,18]</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_UnGenotypedSites_GBSonlySamples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb32-4"><a href="#cb32-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb32-6"><a href="#cb32-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb32-7"><a href="#cb32-7"></a>                  Chr,<span class="st">&quot;_ugC1samples_REFimputedGBSsites_91019.vcf.gz &quot;</span>,</span>
<span id="cb32-8"><a href="#cb32-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb32-9"><a href="#cb32-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb32-10"><a href="#cb32-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb32-11"><a href="#cb32-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb32-12"><a href="#cb32-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb32-13"><a href="#cb32-13"></a>                  Chr,<span class="st">&quot;_ugC1samples_AllSitesREFimputedAndPhased_91019 &quot;</span>,</span>
<span id="cb32-14"><a href="#cb32-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="beaglelogs-1" class="section level2">
<h2>BeagleLogs</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>cd <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>; </span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="co">#mkdir BeagleLogs;</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>cp <span class="op">*</span>_ugC1samples_AllSitesREFimputedAndPhased_<span class="fl">91019.</span>log BeagleLogs<span class="op">/</span></span></code></pre></div>
</div>
<div id="rsync-2" class="section level2">
<h2>Rsync</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># cbsulm__ --&gt; cbsurobbins</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span></span></code></pre></div>
</div>
<div id="post-impute-filter-1" class="section level2">
<h2>Post-impute filter</h2>
<p>AR2&gt;0.75, P_HWE&gt;1e-20, MAF&gt;0.005 [0.5%]</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">library</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb35-2"><a href="#cb35-2"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PostImputeFilter=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){ </span>
<span id="cb35-5"><a href="#cb35-5"></a>            fileIn&lt;-<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,</span>
<span id="cb35-6"><a href="#cb35-6"></a>                           Chr,<span class="st">&quot;_ugC1samples_AllSitesREFimputedAndPhased_91019.vcf.gz &quot;</span>)</span>
<span id="cb35-7"><a href="#cb35-7"></a>            fileOut&lt;-<span class="kw">paste0</span>(<span class="st">&quot;--out &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,</span>
<span id="cb35-8"><a href="#cb35-8"></a>                            Chr,<span class="st">&quot;_ugC1samples_AllSitesREFimputedAndPhased_91019&quot;</span>)</span>
<span id="cb35-9"><a href="#cb35-9"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--get-INFO DR2 --get-INFO AF &quot;</span>,fileOut))</span>
<span id="cb35-10"><a href="#cb35-10"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--hardy &quot;</span>,fileOut)) }))</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>stats2filterOn&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb36-4"><a href="#cb36-4"></a>                                                <span class="st">&quot;_ugC1samples_AllSitesREFimputedAndPhased_91019.INFO&quot;</span>), </span>
<span id="cb36-5"><a href="#cb36-5"></a>                                         <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)),</span>
<span id="cb36-6"><a href="#cb36-6"></a>         <span class="dt">hwe=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb36-7"><a href="#cb36-7"></a>                                               <span class="st">&quot;_ugC1samples_AllSitesREFimputedAndPhased_91019.hwe&quot;</span>), </span>
<span id="cb36-8"><a href="#cb36-8"></a>                                        <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)))</span>
<span id="cb36-9"><a href="#cb36-9"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="st">  </span><span class="kw">select</span>(Chr,INFO,hwe) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-11"><a href="#cb36-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map2</span>(INFO,hwe,<span class="op">~</span><span class="kw">left_join</span>(.x,(.y <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-12"><a href="#cb36-12"></a><span class="st">                                             </span><span class="kw">rename</span>(<span class="dt">CHROM=</span>CHR))))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>hwe)</span>
<span id="cb36-14"><a href="#cb36-14"></a>stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-15"><a href="#cb36-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">NotNumDR2=</span><span class="kw">map_lgl</span>(INFO,<span class="op">~</span><span class="kw">is.numeric</span>(.<span class="op">$</span>DR2)))</span>
<span id="cb36-16"><a href="#cb36-16"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb36-17"><a href="#cb36-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,</span>
<span id="cb36-18"><a href="#cb36-18"></a>                  <span class="op">~</span><span class="kw">mutate</span>(.,</span>
<span id="cb36-19"><a href="#cb36-19"></a>                          <span class="dt">DR2=</span><span class="kw">as.numeric</span>(DR2),</span>
<span id="cb36-20"><a href="#cb36-20"></a>                          <span class="dt">AF=</span><span class="kw">as.numeric</span>(AF)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-21"><a href="#cb36-21"></a><span class="st">                    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(DR2),</span>
<span id="cb36-22"><a href="#cb36-22"></a>                           <span class="op">!</span><span class="kw">is.na</span>(AF))))</span>
<span id="cb36-23"><a href="#cb36-23"></a></span>
<span id="cb36-24"><a href="#cb36-24"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb36-25"><a href="#cb36-25"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,<span class="op">~</span><span class="kw">mutate</span>(.,<span class="dt">MAF=</span><span class="kw">ifelse</span>(AF<span class="op">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span><span class="op">-</span>AF,AF))))</span></code></pre></div>
<p>Check what’s left</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>sitesPassingFilters&lt;-stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">allSitesPassing=</span><span class="kw">map</span>(INFO,</span>
<span id="cb37-3"><a href="#cb37-3"></a>                             <span class="op">~</span><span class="kw">filter</span>(.,DR2<span class="op">&gt;=</span><span class="fl">0.75</span>,</span>
<span id="cb37-4"><a href="#cb37-4"></a>                                     P_HWE<span class="op">&gt;</span><span class="fl">1e-20</span>,</span>
<span id="cb37-5"><a href="#cb37-5"></a>                                     MAF<span class="op">&gt;</span><span class="fl">0.005</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="st">                               </span><span class="kw">select</span>(CHROM,POS))) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>INFO)</span>
<span id="cb37-8"><a href="#cb37-8"></a>stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 65451</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>sitesPassingFilters <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(allSitesPassing) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 24426</span></span>
<span id="cb37-10"><a href="#cb37-10"></a>stats2filterOn</span>
<span id="cb37-11"><a href="#cb37-11"></a>sitesPassingFilters</span>
<span id="cb37-12"><a href="#cb37-12"></a><span class="co">#         Chr allSitesPassing         </span></span>
<span id="cb37-13"><a href="#cb37-13"></a><span class="co">#    &lt;int&gt; &lt;list&gt;                  </span></span>
<span id="cb37-14"><a href="#cb37-14"></a><span class="co">#  1     1 &lt;data.frame [8,201 x 2]&gt;</span></span>
<span id="cb37-15"><a href="#cb37-15"></a><span class="co">#  2     2 &lt;data.frame [3,854 x 2]&gt;</span></span>
<span id="cb37-16"><a href="#cb37-16"></a><span class="co">#  3     3 &lt;data.frame [4,102 x 2]&gt;</span></span>
<span id="cb37-17"><a href="#cb37-17"></a><span class="co">#  4     4 &lt;data.frame [3,773 x 2]&gt;</span></span>
<span id="cb37-18"><a href="#cb37-18"></a><span class="co">#  5     5 &lt;data.frame [3,807 x 2]&gt;</span></span>
<span id="cb37-19"><a href="#cb37-19"></a><span class="co">#  6     6 &lt;data.frame [3,594 x 2]&gt;</span></span>
<span id="cb37-20"><a href="#cb37-20"></a><span class="co">#  7     7 &lt;data.frame [1,959 x 2]&gt;</span></span>
<span id="cb37-21"><a href="#cb37-21"></a><span class="co">#  8     8 &lt;data.frame [3,628 x 2]&gt;</span></span>
<span id="cb37-22"><a href="#cb37-22"></a><span class="co">#  9     9 &lt;data.frame [3,449 x 2]&gt;</span></span>
<span id="cb37-23"><a href="#cb37-23"></a><span class="co"># 10    10 &lt;data.frame [2,901 x 2]&gt;</span></span>
<span id="cb37-24"><a href="#cb37-24"></a><span class="co"># 11    11 &lt;data.frame [3,297 x 2]&gt;</span></span>
<span id="cb37-25"><a href="#cb37-25"></a><span class="co"># 12    12 &lt;data.frame [2,893 x 2]&gt;</span></span>
<span id="cb37-26"><a href="#cb37-26"></a><span class="co"># 13    13 &lt;data.frame [2,773 x 2]&gt;</span></span>
<span id="cb37-27"><a href="#cb37-27"></a><span class="co"># 14    14 &lt;data.frame [4,172 x 2]&gt;</span></span>
<span id="cb37-28"><a href="#cb37-28"></a><span class="co"># 15    15 &lt;data.frame [3,959 x 2]&gt;</span></span>
<span id="cb37-29"><a href="#cb37-29"></a><span class="co"># 16    16 &lt;data.frame [2,875 x 2]&gt;</span></span>
<span id="cb37-30"><a href="#cb37-30"></a><span class="co"># 17    17 &lt;data.frame [2,775 x 2]&gt;</span></span>
<span id="cb37-31"><a href="#cb37-31"></a><span class="co"># 18    18 &lt;data.frame [3,118 x 2]&gt;</span></span></code></pre></div>
</div>
</div>
<div id="form-imputation-refpanelv-for-ugc1" class="section level1">
<h1>Form Imputation RefPanelV for UgC1</h1>
<p>Exclude IITA samples from C1-C4 unless they have GBS+DArT. This is to save memory. Should retain the key haplotypes.</p>
<div id="apply-filter-to-refpaneliv-vcf" class="section level2">
<h2>Apply filter to RefPanelIV VCF</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>refpanelIV&lt;-<span class="kw">read.table</span>(<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageI_82819/&quot;</span>,</span>
<span id="cb38-2"><a href="#cb38-2"></a>                              <span class="st">&quot;chr1_ImputationReferencePanel_StageIV_82819.samples&quot;</span>),</span>
<span id="cb38-3"><a href="#cb38-3"></a>                       <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F)<span class="op">$</span>V1</span>
<span id="cb38-4"><a href="#cb38-4"></a></span>
<span id="cb38-5"><a href="#cb38-5"></a>tzTP&lt;-<span class="kw">read.table</span>(<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span>,</span>
<span id="cb38-6"><a href="#cb38-6"></a>                              <span class="st">&quot;chr1_tzTPsamples_AllSitesREFimputedAndPhased_ReadyToMergeWithRefPanel_91019.samples&quot;</span>),</span>
<span id="cb38-7"><a href="#cb38-7"></a>                       <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F)<span class="op">$</span>V1</span>
<span id="cb38-8"><a href="#cb38-8"></a>samplesWithVerifiedGBSandDart&lt;-<span class="kw">read.table</span>(<span class="dt">file=</span><span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationStageI_71119/&quot;</span>,</span>
<span id="cb38-9"><a href="#cb38-9"></a>                                                      <span class="st">&quot;samplesWithVerifiedGBSandDart_71119.txt&quot;</span>), </span>
<span id="cb38-10"><a href="#cb38-10"></a>                                          <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F)<span class="op">$</span>V1</span>
<span id="cb38-11"><a href="#cb38-11"></a></span>
<span id="cb38-12"><a href="#cb38-12"></a><span class="kw">table</span>(refpanelIV <span class="op">%in%</span><span class="st"> </span>tzTP)</span>
<span id="cb38-13"><a href="#cb38-13"></a><span class="kw">table</span>(refpanelIV <span class="op">%in%</span><span class="st"> </span>samplesWithVerifiedGBSandDart)</span>
<span id="cb38-14"><a href="#cb38-14"></a></span>
<span id="cb38-15"><a href="#cb38-15"></a>iitaSamples2remove&lt;-refpanelIV <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-16"><a href="#cb38-16"></a><span class="st">  </span><span class="kw">grep</span>(<span class="st">&quot;TMS13F|TMS14F|TMS15F|TMS16F|TMS17F|TMS18F|2013_&quot;</span>,.,<span class="dt">value =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-17"><a href="#cb38-17"></a><span class="st">  </span>.[<span class="op">!</span>. <span class="op">%in%</span><span class="st"> </span>samplesWithVerifiedGBSandDart]</span>
<span id="cb38-18"><a href="#cb38-18"></a></span>
<span id="cb38-19"><a href="#cb38-19"></a>refpanelIV <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-20"><a href="#cb38-20"></a><span class="st">  </span>.[<span class="op">!</span>. <span class="op">%in%</span><span class="st"> </span>iitaSamples2remove] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-21"><a href="#cb38-21"></a><span class="st">  </span><span class="kw">c</span>(.,tzTP) <span class="op">%&gt;%</span><span class="st"> </span>length <span class="co"># 13100... reasonable!</span></span>
<span id="cb38-22"><a href="#cb38-22"></a></span>
<span id="cb38-23"><a href="#cb38-23"></a>iitaSamples2remove <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#length # 10170 to remove</span></span>
<span id="cb38-24"><a href="#cb38-24"></a><span class="st">  </span><span class="kw">write.table</span>(.,<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span>,</span>
<span id="cb38-25"><a href="#cb38-25"></a>                       <span class="st">&quot;iitaSamples2remove_fromUgC1RefPanel_91019.txt&quot;</span>),</span>
<span id="cb38-26"><a href="#cb38-26"></a>              <span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">quote =</span> F)</span>
<span id="cb38-27"><a href="#cb38-27"></a></span>
<span id="cb38-28"><a href="#cb38-28"></a></span>
<span id="cb38-29"><a href="#cb38-29"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb38-30"><a href="#cb38-30"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractRefPanelIVsamplesForStageV=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb38-31"><a href="#cb38-31"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageI_82819/chr&quot;</span>,</span>
<span id="cb38-32"><a href="#cb38-32"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIV_82819.vcf.gz &quot;</span>,</span>
<span id="cb38-33"><a href="#cb38-33"></a>                  <span class="st">&quot;--remove /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span>,</span>
<span id="cb38-34"><a href="#cb38-34"></a>                  <span class="st">&quot;iitaSamples2remove_fromUgC1RefPanel_91019.txt &quot;</span>,</span>
<span id="cb38-35"><a href="#cb38-35"></a>                  <span class="st">&quot;--chr &quot;</span>,Chr,<span class="st">&quot; &quot;</span>,</span>
<span id="cb38-36"><a href="#cb38-36"></a>                  <span class="st">&quot;--positions /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb38-37"><a href="#cb38-37"></a>                  Chr,<span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019.sitesPassing &quot;</span>,</span>
<span id="cb38-38"><a href="#cb38-38"></a>                  <span class="st">&quot;--recode &quot;</span>,</span>
<span id="cb38-39"><a href="#cb38-39"></a>                  <span class="st">&quot;--stdout | bgzip -c -@ 24 &gt; &quot;</span>,</span>
<span id="cb38-40"><a href="#cb38-40"></a>                  <span class="st">&quot; /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb38-41"><a href="#cb38-41"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageIVsamples_ReadyToMergeAndFormStageV_91019.vcf.gz&quot;</span>)) }))</span></code></pre></div>
</div>
<div id="merge-refpaneliv-and-tztp-samples" class="section level2">
<h2>Merge RefPanelIV and tzTP samples</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb39-2"><a href="#cb39-2"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Index=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb39-5"><a href="#cb39-5"></a>        <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;tabix -f -p vcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb39-6"><a href="#cb39-6"></a>                      <span class="st">&quot;_ImputationReferencePanel_StageIVsamples_ReadyToMergeAndFormStageV_91019.vcf.gz&quot;</span>))</span>
<span id="cb39-7"><a href="#cb39-7"></a>        <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;tabix -f -p vcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb39-8"><a href="#cb39-8"></a>                      <span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_ReadyToMergeWithRefPanel_91019.vcf.gz&quot;</span>)) }))</span>
<span id="cb39-9"><a href="#cb39-9"></a>    </span>
<span id="cb39-10"><a href="#cb39-10"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Merge=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb39-12"><a href="#cb39-12"></a>        <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;bcftools merge &quot;</span>,</span>
<span id="cb39-13"><a href="#cb39-13"></a>                      <span class="st">&quot;--output &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb39-14"><a href="#cb39-14"></a>                      <span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb39-15"><a href="#cb39-15"></a>                      <span class="st">&quot;--merge snps --output-type z --threads 24 &quot;</span>,</span>
<span id="cb39-16"><a href="#cb39-16"></a>                      pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb39-17"><a href="#cb39-17"></a>                      <span class="st">&quot;_ImputationReferencePanel_StageIVsamples_ReadyToMergeAndFormStageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb39-18"><a href="#cb39-18"></a>                      pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb39-19"><a href="#cb39-19"></a>                      <span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_ReadyToMergeWithRefPanel_91019.vcf.gz&quot;</span>))}))</span></code></pre></div>
</div>
</div>
<div id="impute-ugc1-samples-genotyped-sites-ref-impute-gl-mode-beagle-4.1" class="section level1">
<h1>Impute ugC1 samples @ genotyped sites (REF impute, GL mode, Beagle 4.1)</h1>
<div id="extract-unimputed-ugc1-from-gbs-source-vcfs" class="section level2">
<h2>Extract unimputed UgC1 from GBS source VCFs</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">library</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb40-2"><a href="#cb40-2"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb40-3"><a href="#cb40-3"></a></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractSiteList=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb40-6"><a href="#cb40-6"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;zcat &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb40-7"><a href="#cb40-7"></a>                  <span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb40-8"><a href="#cb40-8"></a>                  <span class="st">&quot;| cut -f1-5 &gt; &quot;</span>,</span>
<span id="cb40-9"><a href="#cb40-9"></a>                  pathIn,<span class="st">&quot;chr&quot;</span>,Chr,<span class="st">&quot;_ImputationReferencePanel_StageV_91019.sitesWithAlleles&quot;</span>))}))</span>
<span id="cb40-10"><a href="#cb40-10"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractSiteList=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb40-12"><a href="#cb40-12"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;zcat /workdir/marnin/June2016_VCF/&quot;</span>,</span>
<span id="cb40-13"><a href="#cb40-13"></a>                  <span class="st">&quot;cassavaGBSbuild_June2016_withRef_chr&quot;</span>,Chr,<span class="st">&quot;.vcf.gz &quot;</span>,</span>
<span id="cb40-14"><a href="#cb40-14"></a>                  <span class="st">&quot;| cut -f1-5 &gt; &quot;</span>,</span>
<span id="cb40-15"><a href="#cb40-15"></a>                  <span class="st">&quot;/workdir/marnin/June2016_VCF/cassavaGBSbuild_June2016_withRef_chr&quot;</span>,Chr,<span class="st">&quot;.sitesWithAlleles&quot;</span>))}))</span>
<span id="cb40-16"><a href="#cb40-16"></a></span>
<span id="cb40-17"><a href="#cb40-17"></a>gbs_sites&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb40-18"><a href="#cb40-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sites=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/June2016_VCF/&quot;</span>,</span>
<span id="cb40-19"><a href="#cb40-19"></a>                                                     <span class="st">&quot;cassavaGBSbuild_June2016_withRef_chr&quot;</span>,.,<span class="st">&quot;.sitesWithAlleles&quot;</span>),</span>
<span id="cb40-20"><a href="#cb40-20"></a>                                         <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F)))</span>
<span id="cb40-21"><a href="#cb40-21"></a>refpanelV_sites&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb40-22"><a href="#cb40-22"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sites=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb40-23"><a href="#cb40-23"></a>                                                 <span class="st">&quot;_ImputationReferencePanel_StageV_91019.sitesWithAlleles&quot;</span>),</span>
<span id="cb40-24"><a href="#cb40-24"></a>                                          <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F)))</span>
<span id="cb40-25"><a href="#cb40-25"></a>gbs_sites <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()</span>
<span id="cb40-26"><a href="#cb40-26"></a>refpanelV_sites <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()</span>
<span id="cb40-27"><a href="#cb40-27"></a></span>
<span id="cb40-28"><a href="#cb40-28"></a>refpanelV_sites <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-29"><a href="#cb40-29"></a><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-30"><a href="#cb40-30"></a><span class="st">  </span><span class="kw">semi_join</span>(gbs_sites <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-31"><a href="#cb40-31"></a><span class="st">  </span><span class="kw">group_by</span>(Chr) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-32"><a href="#cb40-32"></a><span class="st">  </span><span class="kw">nest</span>(<span class="dt">.key =</span> <span class="st">&quot;allSitesPassing&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-33"><a href="#cb40-33"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Sites2Keep=</span><span class="kw">future_map2</span>(Chr,allSitesPassing,<span class="cf">function</span>(Chr,allSitesPassing){ </span>
<span id="cb40-34"><a href="#cb40-34"></a>        pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb40-35"><a href="#cb40-35"></a>        sitesPassing_thisChr&lt;-allSitesPassing <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-36"><a href="#cb40-36"></a><span class="st">          </span><span class="kw">select</span>(V1,V2)</span>
<span id="cb40-37"><a href="#cb40-37"></a>        <span class="kw">write.table</span>(sitesPassing_thisChr,</span>
<span id="cb40-38"><a href="#cb40-38"></a>                    <span class="dt">file =</span> <span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb40-39"><a href="#cb40-39"></a>                                  <span class="st">&quot;_ugC1samples_sitesInRefPanelVtoImpute_91019.sites2keep&quot;</span>),</span>
<span id="cb40-40"><a href="#cb40-40"></a>                    <span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">quote =</span> F)}))</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">require</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractRaw_gbsSamples=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb41-4"><a href="#cb41-4"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf /workdir/marnin/June2016_VCF/&quot;</span>,</span>
<span id="cb41-5"><a href="#cb41-5"></a>                  <span class="st">&quot;cassavaGBSbuild_June2016_withRef_chr&quot;</span>,Chr,<span class="st">&quot;.vcf.gz &quot;</span>,</span>
<span id="cb41-6"><a href="#cb41-6"></a>                  <span class="st">&quot;--keep /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span>,</span>
<span id="cb41-7"><a href="#cb41-7"></a>                  <span class="st">&quot;gbsOnlySamplesToImpute_ugC1_90919.txt &quot;</span>,</span>
<span id="cb41-8"><a href="#cb41-8"></a>                  <span class="st">&quot;--chr &quot;</span>,Chr,<span class="st">&quot; &quot;</span>,</span>
<span id="cb41-9"><a href="#cb41-9"></a>                  <span class="st">&quot;--positions /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb41-10"><a href="#cb41-10"></a>                  Chr,<span class="st">&quot;_ugC1samples_sitesInRefPanelVtoImpute_91019.sites2keep &quot;</span>,</span>
<span id="cb41-11"><a href="#cb41-11"></a>                  <span class="st">&quot;--recode --stdout | &quot;</span>,</span>
<span id="cb41-12"><a href="#cb41-12"></a>                  <span class="st">&quot;awk &#39;$4 != </span><span class="ch">\&quot;</span><span class="st">-</span><span class="ch">\&quot;</span><span class="st"> {print}&#39; | awk &#39;$5 != </span><span class="ch">\&quot;</span><span class="st">-</span><span class="ch">\&quot;</span><span class="st"> {print}&#39; | grep -v &#39;INFO=&#39; | &quot;</span>,</span>
<span id="cb41-13"><a href="#cb41-13"></a>                  <span class="st">&quot;bgzip -c -@ 24 &gt; &quot;</span>,</span>
<span id="cb41-14"><a href="#cb41-14"></a>                  <span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb41-15"><a href="#cb41-15"></a>                  Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_Ready2REFimpute_91019.vcf.gz&quot;</span>)) }))</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1"></a><span class="ex">vcftools</span> --gzvcf /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr1_ugC1samples_FromJune2016vcf_Ready2REFimpute_91019.vcf.gz</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">zcat</span> /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr1_ugC1samples_FromJune2016vcf_Ready2REFimpute_91019.vcf.gz <span class="kw">|</span> <span class="fu">head</span> -n40 <span class="kw">|</span> <span class="fu">cut</span> -f1-12</span></code></pre></div>
<p>1:29425054 [-]</p>
</div>
<div id="rsync-3" class="section level2">
<h2>Rsync</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># cbsulm__ --&gt; cbsurobbins</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span></span>
<span id="cb43-4"><a href="#cb43-4"></a></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="co"># cbsurobbins --&gt; cbsulm__</span></span>
<span id="cb43-6"><a href="#cb43-6"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm17.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb43-7"><a href="#cb43-7"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm16.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb43-8"><a href="#cb43-8"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm14.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb43-9"><a href="#cb43-9"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm13.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb43-10"><a href="#cb43-10"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm12.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb43-11"><a href="#cb43-11"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm07.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span></code></pre></div>
</div>
<div id="cbsulm17-112-1231-iter4...23" class="section level2">
<h2>cbsulm17 (112) <span class="citation">[1 @iter4...,2,3]</span></h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_GenotypedSites_GBSonly_ugC1samples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb44-4"><a href="#cb44-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle41/beagle41.jar &quot;</span>,</span>
<span id="cb44-6"><a href="#cb44-6"></a>                      <span class="st">&quot;gl=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb44-7"><a href="#cb44-7"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_Ready2REFimpute_91019.vcf.gz &quot;</span>,</span>
<span id="cb44-8"><a href="#cb44-8"></a>                      <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb44-9"><a href="#cb44-9"></a>                      Chr,<span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb44-10"><a href="#cb44-10"></a>                      <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb44-11"><a href="#cb44-11"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGLmode_91019 &quot;</span>,</span>
<span id="cb44-12"><a href="#cb44-12"></a>                      <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; niterations=10&quot;</span>))}))</span></code></pre></div>
<p>Window=1 Iteration=1 Time for building model: 16 minutes 29 seconds Time for sampling (singles): 31 hours 32 minutes 39 seconds Window=1 Iteration=2 Time for building model: 23 minutes 59 seconds Time for sampling (singles): 28 hours 8 minutes 5 seconds Window=1 Iteration=3 Time for building model: 24 minutes 58 seconds Time for sampling (singles): 30 hours 24 minutes 33 seconds Window=1 Iteration=4 Time for building model: 24 minutes 16 seconds Time for sampling (singles): 27 hours 31 minutes 15 seconds</p>
</div>
<div id="cbsulm16-112-4-done564-done5-iter56" class="section level2">
<h2>cbsulm16 (112) <span class="citation">[4 done,5 @iter5,6]</span></h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_GenotypedSites_GBSonly_ugC1samples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb45-4"><a href="#cb45-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle41/beagle41.jar &quot;</span>,</span>
<span id="cb45-6"><a href="#cb45-6"></a>                      <span class="st">&quot;gl=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb45-7"><a href="#cb45-7"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_Ready2REFimpute_91019.vcf.gz &quot;</span>,</span>
<span id="cb45-8"><a href="#cb45-8"></a>                      <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb45-9"><a href="#cb45-9"></a>                      Chr,<span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb45-10"><a href="#cb45-10"></a>                      <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb45-11"><a href="#cb45-11"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGLmode_91019 &quot;</span>,</span>
<span id="cb45-12"><a href="#cb45-12"></a>                      <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; niterations=10&quot;</span>))}))</span>
<span id="cb45-13"><a href="#cb45-13"></a><span class="co"># Window=1 Iteration=2</span></span>
<span id="cb45-14"><a href="#cb45-14"></a><span class="co"># Time for building model:         7 minutes 9 seconds</span></span>
<span id="cb45-15"><a href="#cb45-15"></a><span class="co"># Time for sampling (singles):     6 hours 24 minutes 54 seconds</span></span>
<span id="cb45-16"><a href="#cb45-16"></a><span class="co"># Window=1 Iteration=5</span></span>
<span id="cb45-17"><a href="#cb45-17"></a><span class="co"># Time for building model:         7 minutes 5 seconds</span></span>
<span id="cb45-18"><a href="#cb45-18"></a><span class="co"># Time for sampling (singles):     6 hours 56 minutes 43 seconds</span></span>
<span id="cb45-19"><a href="#cb45-19"></a><span class="co"># Window=1 Iteration=8</span></span>
<span id="cb45-20"><a href="#cb45-20"></a><span class="co"># Time for building model:         7 minutes 53 seconds</span></span>
<span id="cb45-21"><a href="#cb45-21"></a><span class="co"># Time for sampling (singles):     7 hours 13 minutes 27 seconds</span></span></code></pre></div>
</div>
<div id="cbsulm14-112-rez-ending-today-7-done89-cancelled7-done8-iter89-cancelled" class="section level2">
<h2>cbsulm14 (112) [REZ ENDING TODAY] <span class="citation">[7 done,8 @iter8,9 cancelled ]</span></h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_GenotypedSites_GBSonly_ugC1samples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb46-4"><a href="#cb46-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle41/beagle41.jar &quot;</span>,</span>
<span id="cb46-6"><a href="#cb46-6"></a>                      <span class="st">&quot;gl=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb46-7"><a href="#cb46-7"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_Ready2REFimpute_91019.vcf.gz &quot;</span>,</span>
<span id="cb46-8"><a href="#cb46-8"></a>                      <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb46-9"><a href="#cb46-9"></a>                      Chr,<span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb46-10"><a href="#cb46-10"></a>                      <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb46-11"><a href="#cb46-11"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGLmode_91019 &quot;</span>,</span>
<span id="cb46-12"><a href="#cb46-12"></a>                      <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; niterations=10&quot;</span>))}))</span>
<span id="cb46-13"><a href="#cb46-13"></a><span class="co"># Chr 7</span></span>
<span id="cb46-14"><a href="#cb46-14"></a><span class="co"># Window=1 Iteration=10</span></span>
<span id="cb46-15"><a href="#cb46-15"></a><span class="co"># Time for building model:         1 minute 57 seconds</span></span>
<span id="cb46-16"><a href="#cb46-16"></a><span class="co"># Time for sampling (singles):     1 hour 37 minutes 59 seconds</span></span>
<span id="cb46-17"><a href="#cb46-17"></a><span class="co"># Window=1 Iteration=11</span></span>
<span id="cb46-18"><a href="#cb46-18"></a><span class="co"># Time for building model:         1 minute 48 seconds</span></span>
<span id="cb46-19"><a href="#cb46-19"></a><span class="co"># Time for sampling (singles):     7 minutes 36 seconds</span></span>
<span id="cb46-20"><a href="#cb46-20"></a><span class="co"># </span></span>
<span id="cb46-21"><a href="#cb46-21"></a><span class="co"># Chr 8</span></span>
<span id="cb46-22"><a href="#cb46-22"></a><span class="co"># Window=1 Iteration=3</span></span>
<span id="cb46-23"><a href="#cb46-23"></a><span class="co"># Time for building model:         4 minutes 58 seconds</span></span>
<span id="cb46-24"><a href="#cb46-24"></a><span class="co"># Time for sampling (singles):     5 hours 32 minutes 27 seconds</span></span>
<span id="cb46-25"><a href="#cb46-25"></a><span class="co"># Window=1 Iteration=7</span></span>
<span id="cb46-26"><a href="#cb46-26"></a><span class="co"># Time for building model:         4 minutes 58 seconds</span></span>
<span id="cb46-27"><a href="#cb46-27"></a><span class="co"># Time for sampling (singles):     5 hours 40 minutes 3 seconds</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>rm chr9_ugC1samples_FromJune2016vcf_REFimputedGLmode_<span class="dv">91019</span><span class="op">*</span></span></code></pre></div>
</div>
<div id="cbsulm13-96-10-done11-done1210-done11-done12-iter0" class="section level2">
<h2>cbsulm13 (96) <span class="citation">[10 done,11 done,12 @iter0]</span></h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_GenotypedSites_GBSonly_ugC1samples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb48-4"><a href="#cb48-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb48-5"><a href="#cb48-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle41/beagle41.jar &quot;</span>,</span>
<span id="cb48-6"><a href="#cb48-6"></a>                      <span class="st">&quot;gl=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb48-7"><a href="#cb48-7"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_Ready2REFimpute_91019.vcf.gz &quot;</span>,</span>
<span id="cb48-8"><a href="#cb48-8"></a>                      <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb48-9"><a href="#cb48-9"></a>                      Chr,<span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb48-10"><a href="#cb48-10"></a>                      <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb48-11"><a href="#cb48-11"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGLmode_91019 &quot;</span>,</span>
<span id="cb48-12"><a href="#cb48-12"></a>                      <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; niterations=10&quot;</span>))}))</span>
<span id="cb48-13"><a href="#cb48-13"></a><span class="co"># Chr. 10</span></span>
<span id="cb48-14"><a href="#cb48-14"></a><span class="co"># Window=1 Iteration=4</span></span>
<span id="cb48-15"><a href="#cb48-15"></a><span class="co"># Time for building model:         4 minutes 19 seconds</span></span>
<span id="cb48-16"><a href="#cb48-16"></a><span class="co"># Time for sampling (singles):     3 hours 45 minutes 9 seconds</span></span>
<span id="cb48-17"><a href="#cb48-17"></a><span class="co"># Window=1 Iteration=9</span></span>
<span id="cb48-18"><a href="#cb48-18"></a><span class="co"># Time for building model:         4 minutes 48 seconds</span></span>
<span id="cb48-19"><a href="#cb48-19"></a><span class="co"># Time for sampling (singles):     4 hours 30 minutes 56 seconds</span></span>
<span id="cb48-20"><a href="#cb48-20"></a><span class="co"># Number of markers:                2786</span></span>
<span id="cb48-21"><a href="#cb48-21"></a><span class="co"># Total time for building model: 1 hour 27 minutes 48 seconds</span></span>
<span id="cb48-22"><a href="#cb48-22"></a><span class="co"># Total time for sampling:       41 hours 38 minutes 45 seconds</span></span>
<span id="cb48-23"><a href="#cb48-23"></a><span class="co"># Total run time:                43 hours 6 minutes 49 seconds</span></span>
<span id="cb48-24"><a href="#cb48-24"></a><span class="co"># </span></span>
<span id="cb48-25"><a href="#cb48-25"></a><span class="co"># Chr. 11</span></span>
<span id="cb48-26"><a href="#cb48-26"></a><span class="co"># Window=1 Iteration=1</span></span>
<span id="cb48-27"><a href="#cb48-27"></a><span class="co"># Time for building model:         4 minutes 14 seconds</span></span>
<span id="cb48-28"><a href="#cb48-28"></a><span class="co"># Time for sampling (singles):     8 hours 48 minutes 18 seconds</span></span>
<span id="cb48-29"><a href="#cb48-29"></a><span class="co"># Window=1 Iteration=2</span></span>
<span id="cb48-30"><a href="#cb48-30"></a><span class="co"># Time for building model:         5 minutes 16 seconds</span></span>
<span id="cb48-31"><a href="#cb48-31"></a><span class="co"># Time for sampling (singles):     7 hours 33 minutes 32 seconds</span></span>
<span id="cb48-32"><a href="#cb48-32"></a><span class="co"># Window=1 Iteration=5</span></span>
<span id="cb48-33"><a href="#cb48-33"></a><span class="co"># Time for building model:         5 minutes 50 seconds</span></span>
<span id="cb48-34"><a href="#cb48-34"></a><span class="co"># Time for sampling (singles):     10 hours 9 minutes 35 seconds</span></span>
<span id="cb48-35"><a href="#cb48-35"></a><span class="co"># Number of markers:                3173</span></span>
<span id="cb48-36"><a href="#cb48-36"></a><span class="co"># Total time for building model: 2 hours 18 minutes 26 seconds</span></span>
<span id="cb48-37"><a href="#cb48-37"></a><span class="co"># Total time for sampling:       87 hours 44 minutes 39 seconds</span></span>
<span id="cb48-38"><a href="#cb48-38"></a><span class="co"># Total run time:                90 hours 3 minutes 23 seconds</span></span></code></pre></div>
</div>
<div id="cbsulm12-96-14-failed131514-failed13-iter115" class="section level2">
<h2>cbsulm12 (96) <span class="citation">[14 FAILED,13 @iter1,15]</span></h2>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">14</span>,<span class="dv">13</span>,<span class="dv">15</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_GenotypedSites_GBSonly_ugC1samples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb49-4"><a href="#cb49-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb49-5"><a href="#cb49-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle41/beagle41.jar &quot;</span>,</span>
<span id="cb49-6"><a href="#cb49-6"></a>                      <span class="st">&quot;gl=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb49-7"><a href="#cb49-7"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_Ready2REFimpute_91019.vcf.gz &quot;</span>,</span>
<span id="cb49-8"><a href="#cb49-8"></a>                      <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb49-9"><a href="#cb49-9"></a>                      Chr,<span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb49-10"><a href="#cb49-10"></a>                      <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb49-11"><a href="#cb49-11"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGLmode_91019 &quot;</span>,</span>
<span id="cb49-12"><a href="#cb49-12"></a>                      <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; niterations=10&quot;</span>))}))</span>
<span id="cb49-13"><a href="#cb49-13"></a><span class="co"># Chr. 14</span></span>
<span id="cb49-14"><a href="#cb49-14"></a><span class="co"># Window=1 Iteration=2</span></span>
<span id="cb49-15"><a href="#cb49-15"></a><span class="co"># Time for building model:         14 minutes 3 seconds</span></span>
<span id="cb49-16"><a href="#cb49-16"></a><span class="co"># Time for sampling (singles):     16 hours 9 minutes 24 seconds</span></span>
<span id="cb49-17"><a href="#cb49-17"></a><span class="co"># Window=1 Iteration=3</span></span>
<span id="cb49-18"><a href="#cb49-18"></a><span class="co"># Time for building model:         10 minutes 38 seconds</span></span>
<span id="cb49-19"><a href="#cb49-19"></a><span class="co"># Time for sampling (singles):     19 hours 23 minutes 21 seconds</span></span>
<span id="cb49-20"><a href="#cb49-20"></a><span class="co"># Window=1 Iteration=4</span></span>
<span id="cb49-21"><a href="#cb49-21"></a><span class="co"># Time for building model:         11 minutes 57 seconds</span></span>
<span id="cb49-22"><a href="#cb49-22"></a><span class="co"># Time for sampling (singles):     16 hours 35 minutes 9 seconds</span></span>
<span id="cb49-23"><a href="#cb49-23"></a><span class="co"># </span></span>
<span id="cb49-24"><a href="#cb49-24"></a><span class="co"># Window=1 Iteration=7</span></span>
<span id="cb49-25"><a href="#cb49-25"></a><span class="co"># Time for building model:         10 minutes 0 seconds</span></span>
<span id="cb49-26"><a href="#cb49-26"></a><span class="co"># Time for sampling (singles):     20 hours 10 minutes 9 seconds</span></span>
<span id="cb49-27"><a href="#cb49-27"></a><span class="co"># DAG statistics</span></span>
<span id="cb49-28"><a href="#cb49-28"></a><span class="co"># mean edges/level: 651    max edges/level: 1150</span></span>
<span id="cb49-29"><a href="#cb49-29"></a><span class="co"># mean edges/node:  1.054  mean count/edge: 46</span></span>
<span id="cb49-30"><a href="#cb49-30"></a><span class="co"># Java HotSpot(TM) 64-Bit Server VM warning: INFO: os::commit_memory(0x00007eca31400000, 71757725696, 0) failed; error=&#39;Cannot allocate memory&#39; (errno=12)</span></span>
<span id="cb49-31"><a href="#cb49-31"></a><span class="co"># There is insufficient memory for the Java Runtime Environment to continue.</span></span>
<span id="cb49-32"><a href="#cb49-32"></a><span class="co"># Native memory allocation (mmap) failed to map 71757725696 bytes for committing reserved memory.</span></span>
<span id="cb49-33"><a href="#cb49-33"></a><span class="co"># An error report file with more information is saved as:</span></span>
<span id="cb49-34"><a href="#cb49-34"></a><span class="co"># /local/workdir/mw489/hs_err_pid42464.log</span></span>
<span id="cb49-35"><a href="#cb49-35"></a><span class="co"># </span></span>
<span id="cb49-36"><a href="#cb49-36"></a><span class="co"># Chr. 13</span></span>
<span id="cb49-37"><a href="#cb49-37"></a><span class="co"># Window=1 Iteration=1</span></span>
<span id="cb49-38"><a href="#cb49-38"></a><span class="co"># Time for building model:         3 minutes 34 seconds</span></span>
<span id="cb49-39"><a href="#cb49-39"></a><span class="co"># Time for sampling (singles):     5 hours 3 minutes 50 seconds</span></span></code></pre></div>
</div>
<div id="cbsulm07-64-16-done-17-and-18" class="section level2">
<h2>cbsulm07 (64) [16 done] [17 and 18?]</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">16</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_GenotypedSites_GBSonly_ugC1samples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb50-4"><a href="#cb50-4"></a>    nthreads&lt;-<span class="dv">64</span></span>
<span id="cb50-5"><a href="#cb50-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle41/beagle41.jar &quot;</span>,</span>
<span id="cb50-6"><a href="#cb50-6"></a>                      <span class="st">&quot;gl=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb50-7"><a href="#cb50-7"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_Ready2REFimpute_91019.vcf.gz &quot;</span>,</span>
<span id="cb50-8"><a href="#cb50-8"></a>                      <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb50-9"><a href="#cb50-9"></a>                      Chr,<span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb50-10"><a href="#cb50-10"></a>                      <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb50-11"><a href="#cb50-11"></a>                      Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGLmode_91019 &quot;</span>,</span>
<span id="cb50-12"><a href="#cb50-12"></a>                      <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; niterations=10&quot;</span>))}))</span>
<span id="cb50-13"><a href="#cb50-13"></a><span class="co"># Window=1 Iteration=1</span></span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="co"># Time for building model:         5 minutes 15 seconds</span></span>
<span id="cb50-15"><a href="#cb50-15"></a><span class="co"># Time for sampling (singles):     12 hours 36 minutes 47 seconds</span></span>
<span id="cb50-16"><a href="#cb50-16"></a><span class="co"># Window=1 Iteration=2</span></span>
<span id="cb50-17"><a href="#cb50-17"></a><span class="co"># Time for building model:         6 minutes 2 seconds</span></span>
<span id="cb50-18"><a href="#cb50-18"></a><span class="co"># Time for sampling (singles):     12 hours 7 minutes 51 seconds</span></span>
<span id="cb50-19"><a href="#cb50-19"></a><span class="co"># Window=1 Iteration=3</span></span>
<span id="cb50-20"><a href="#cb50-20"></a><span class="co"># Time for building model:         6 minutes 38 seconds</span></span>
<span id="cb50-21"><a href="#cb50-21"></a><span class="co"># Time for sampling (singles):     10 hours 50 minutes 41 seconds</span></span>
<span id="cb50-22"><a href="#cb50-22"></a><span class="co"># Window=1 Iteration=5</span></span>
<span id="cb50-23"><a href="#cb50-23"></a><span class="co"># Time for building model:         9 minutes 28 seconds</span></span>
<span id="cb50-24"><a href="#cb50-24"></a><span class="co"># Time for sampling (singles):     10 hours 52 minutes 11 seconds</span></span>
<span id="cb50-25"><a href="#cb50-25"></a><span class="co"># Number of markers:                2778</span></span>
<span id="cb50-26"><a href="#cb50-26"></a><span class="co"># Total time for building model: 2 hours 41 minutes 47 seconds</span></span>
<span id="cb50-27"><a href="#cb50-27"></a><span class="co"># Total time for sampling:       125 hours 32 minutes 28 seconds</span></span>
<span id="cb50-28"><a href="#cb50-28"></a><span class="co"># Total run time:                128 hours 14 minutes 42 seconds</span></span></code></pre></div>
</div>
<div id="beaglelogs-2" class="section level2">
<h2>BeagleLogs</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>cd <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>; </span>
<span id="cb51-2"><a href="#cb51-2"></a>cp <span class="op">*</span>_ugC1samples_FromJune2016vcf_REFimputedGLmode_<span class="fl">91019.</span>log BeagleLogs<span class="op">/</span></span></code></pre></div>
</div>
<div id="rsync-4" class="section level2">
<h2>Rsync</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># cbsulm__ --&gt; cbsurobbins</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span></span></code></pre></div>
</div>
<div id="post-impute-filter-2" class="section level2">
<h2>Post-impute filter</h2>
<p>AR2&gt;0.75, P_HWE&gt;1e-20, MAF&gt;0.005 [0.5%]</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">library</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb53-2"><a href="#cb53-2"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PostImputeFilter=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){ </span>
<span id="cb53-5"><a href="#cb53-5"></a>            fileIn&lt;-<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,</span>
<span id="cb53-6"><a href="#cb53-6"></a>                           Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGLmode_91019.vcf.gz &quot;</span>)</span>
<span id="cb53-7"><a href="#cb53-7"></a>            fileOut&lt;-<span class="kw">paste0</span>(<span class="st">&quot;--out &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,</span>
<span id="cb53-8"><a href="#cb53-8"></a>                            Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGLmode_91019&quot;</span>)</span>
<span id="cb53-9"><a href="#cb53-9"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--get-INFO AR2 --get-INFO AF &quot;</span>,fileOut))</span>
<span id="cb53-10"><a href="#cb53-10"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--hardy &quot;</span>,fileOut)) }))</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>stats2filterOn&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb54-4"><a href="#cb54-4"></a>                                                <span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019.INFO&quot;</span>), </span>
<span id="cb54-5"><a href="#cb54-5"></a>                                         <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)),</span>
<span id="cb54-6"><a href="#cb54-6"></a>         <span class="dt">hwe=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb54-7"><a href="#cb54-7"></a>                                               <span class="st">&quot;_tzTPsamples_AllSitesREFimputedAndPhased_91019.hwe&quot;</span>), </span>
<span id="cb54-8"><a href="#cb54-8"></a>                                        <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)))</span>
<span id="cb54-9"><a href="#cb54-9"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb54-10"><a href="#cb54-10"></a><span class="st">  </span><span class="kw">select</span>(Chr,INFO,hwe) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-11"><a href="#cb54-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map2</span>(INFO,hwe,<span class="op">~</span><span class="kw">left_join</span>(.x,(.y <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-12"><a href="#cb54-12"></a><span class="st">                                             </span><span class="kw">rename</span>(<span class="dt">CHROM=</span>CHR))))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-13"><a href="#cb54-13"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>hwe)</span>
<span id="cb54-14"><a href="#cb54-14"></a>stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-15"><a href="#cb54-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">NotNumDR2=</span><span class="kw">map_lgl</span>(INFO,<span class="op">~</span><span class="kw">is.numeric</span>(.<span class="op">$</span>DR2)))</span>
<span id="cb54-16"><a href="#cb54-16"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb54-17"><a href="#cb54-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,</span>
<span id="cb54-18"><a href="#cb54-18"></a>                  <span class="op">~</span><span class="kw">mutate</span>(.,</span>
<span id="cb54-19"><a href="#cb54-19"></a>                          <span class="dt">DR2=</span><span class="kw">as.numeric</span>(DR2),</span>
<span id="cb54-20"><a href="#cb54-20"></a>                          <span class="dt">AF=</span><span class="kw">as.numeric</span>(AF)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-21"><a href="#cb54-21"></a><span class="st">                    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(DR2),</span>
<span id="cb54-22"><a href="#cb54-22"></a>                           <span class="op">!</span><span class="kw">is.na</span>(AF))))</span>
<span id="cb54-23"><a href="#cb54-23"></a></span>
<span id="cb54-24"><a href="#cb54-24"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb54-25"><a href="#cb54-25"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,<span class="op">~</span><span class="kw">mutate</span>(.,<span class="dt">MAF=</span><span class="kw">ifelse</span>(AF<span class="op">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span><span class="op">-</span>AF,AF))))</span></code></pre></div>
<p>Check what’s left</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>sitesPassingFilters&lt;-stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">allSitesPassing=</span><span class="kw">map</span>(INFO,</span>
<span id="cb55-3"><a href="#cb55-3"></a>                             <span class="op">~</span><span class="kw">filter</span>(.,DR2<span class="op">&gt;=</span><span class="fl">0.75</span>,</span>
<span id="cb55-4"><a href="#cb55-4"></a>                                     P_HWE<span class="op">&gt;</span><span class="fl">1e-20</span>,</span>
<span id="cb55-5"><a href="#cb55-5"></a>                                     MAF<span class="op">&gt;</span><span class="fl">0.005</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb55-6"><a href="#cb55-6"></a><span class="st">                               </span><span class="kw">select</span>(CHROM,POS))) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb55-7"><a href="#cb55-7"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>INFO)</span>
<span id="cb55-8"><a href="#cb55-8"></a>stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 65451</span></span>
<span id="cb55-9"><a href="#cb55-9"></a>sitesPassingFilters <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(allSitesPassing) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 65130</span></span>
<span id="cb55-10"><a href="#cb55-10"></a>stats2filterOn</span>
<span id="cb55-11"><a href="#cb55-11"></a>sitesPassingFilters</span></code></pre></div>
<pre><code>    Chr allSitesPassing         </code></pre>
<p><int> <list></p>
<p>Apply filter</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>sitesPassingFilters <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PostImputePrePhaseFilter=</span><span class="kw">future_map2</span>(Chr,allSitesPassing,<span class="cf">function</span>(Chr,allSitesPassing){ </span>
<span id="cb57-3"><a href="#cb57-3"></a>        pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb57-4"><a href="#cb57-4"></a>    sitesPassing_thisChr&lt;-allSitesPassing <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="st">      </span><span class="kw">select</span>(CHROM,POS)</span>
<span id="cb57-6"><a href="#cb57-6"></a>    <span class="kw">write.table</span>(sitesPassing_thisChr,</span>
<span id="cb57-7"><a href="#cb57-7"></a>                <span class="dt">file =</span> <span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb57-8"><a href="#cb57-8"></a>                              <span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGLmode_91019.sitesPassing&quot;</span>),</span>
<span id="cb57-9"><a href="#cb57-9"></a>                <span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">quote =</span> F)</span>
<span id="cb57-10"><a href="#cb57-10"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb57-11"><a href="#cb57-11"></a>                  <span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGLmode_91019.vcf.gz &quot;</span>,</span>
<span id="cb57-12"><a href="#cb57-12"></a>                  <span class="st">&quot;--positions &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb57-13"><a href="#cb57-13"></a>                  <span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGLmode_91019.sitesPassing &quot;</span>,</span>
<span id="cb57-14"><a href="#cb57-14"></a>                  <span class="st">&quot;--recode --stdout | &quot;</span>,</span>
<span id="cb57-15"><a href="#cb57-15"></a>                  <span class="st">&quot;bgzip -c -@ 24 &gt; &quot;</span>,</span>
<span id="cb57-16"><a href="#cb57-16"></a>                  pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb57-17"><a href="#cb57-17"></a>                  <span class="st">&quot;_ugC1samples_FromJune2016vcf_ReadyToPhaseAndImputeUngenotypedSites_91119.vcf.gz&quot;</span>))}))</span></code></pre></div>
</div>
<div id="rsync-5" class="section level2">
<h2>Rsync</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># cbsulm__ --&gt; cbsurobbins</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span></span>
<span id="cb58-4"><a href="#cb58-4"></a></span>
<span id="cb58-5"><a href="#cb58-5"></a><span class="co"># cbsurobbins --&gt; cbsulm__</span></span>
<span id="cb58-6"><a href="#cb58-6"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm17.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb58-7"><a href="#cb58-7"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm16.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb58-8"><a href="#cb58-8"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm14.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb58-9"><a href="#cb58-9"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm13.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb58-10"><a href="#cb58-10"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm12.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb58-11"><a href="#cb58-11"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm07.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span></code></pre></div>
</div>
</div>
<div id="impute-ugc1-samples-genotyped-sites-ref-impute-gt-mode-beagle-5" class="section level1">
<h1>Impute ugC1 samples @ genotyped sites (REF impute, GT mode, Beagle 5)</h1>
<p>I realized I can try Beagle5 using carefully filtered TASSEL GT calls on the unimputed data. Maybe the phasing screwed stuff up on the previous UgC1 imputation. I had thought Beagle5 required the genotyped sites in a target dataset to bet phased and not contain missing. However, suggests that missingness and lack-of-phase is handled, just GL are not handled.</p>
<div id="extract-unimputed-ugc1-from-gbs-source-vcfs-1" class="section level2">
<h2>Extract unimputed UgC1 from GBS source VCFs</h2>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">library</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb59-2"><a href="#cb59-2"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb59-3"><a href="#cb59-3"></a></span>
<span id="cb59-4"><a href="#cb59-4"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb59-5"><a href="#cb59-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractSiteList=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb59-6"><a href="#cb59-6"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;zcat &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb59-7"><a href="#cb59-7"></a>                  <span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb59-8"><a href="#cb59-8"></a>                  <span class="st">&quot;| cut -f1-5 &gt; &quot;</span>,</span>
<span id="cb59-9"><a href="#cb59-9"></a>                  pathIn,<span class="st">&quot;chr&quot;</span>,Chr,<span class="st">&quot;_ImputationReferencePanel_StageV_91019.sitesWithAlleles&quot;</span>))}))</span>
<span id="cb59-10"><a href="#cb59-10"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb59-11"><a href="#cb59-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractSiteList=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb59-12"><a href="#cb59-12"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;zcat /workdir/marnin/June2016_VCF/&quot;</span>,</span>
<span id="cb59-13"><a href="#cb59-13"></a>                  <span class="st">&quot;cassavaGBSbuild_June2016_withRef_chr&quot;</span>,Chr,<span class="st">&quot;.vcf.gz &quot;</span>,</span>
<span id="cb59-14"><a href="#cb59-14"></a>                  <span class="st">&quot;| cut -f1-5 &gt; &quot;</span>,</span>
<span id="cb59-15"><a href="#cb59-15"></a>                  <span class="st">&quot;/workdir/marnin/June2016_VCF/cassavaGBSbuild_June2016_withRef_chr&quot;</span>,Chr,<span class="st">&quot;.sitesWithAlleles&quot;</span>))}))</span>
<span id="cb59-16"><a href="#cb59-16"></a></span>
<span id="cb59-17"><a href="#cb59-17"></a>gbs_sites&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb59-18"><a href="#cb59-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sites=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(<span class="st">&quot;/workdir/marnin/June2016_VCF/&quot;</span>,</span>
<span id="cb59-19"><a href="#cb59-19"></a>                                                     <span class="st">&quot;cassavaGBSbuild_June2016_withRef_chr&quot;</span>,.,<span class="st">&quot;.sitesWithAlleles&quot;</span>),</span>
<span id="cb59-20"><a href="#cb59-20"></a>                                         <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F)))</span>
<span id="cb59-21"><a href="#cb59-21"></a>refpanelV_sites&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb59-22"><a href="#cb59-22"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sites=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb59-23"><a href="#cb59-23"></a>                                                 <span class="st">&quot;_ImputationReferencePanel_StageV_91019.sitesWithAlleles&quot;</span>),</span>
<span id="cb59-24"><a href="#cb59-24"></a>                                          <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> F)))</span>
<span id="cb59-25"><a href="#cb59-25"></a>gbs_sites <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()</span>
<span id="cb59-26"><a href="#cb59-26"></a>refpanelV_sites <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()</span>
<span id="cb59-27"><a href="#cb59-27"></a></span>
<span id="cb59-28"><a href="#cb59-28"></a>refpanelV_sites <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-29"><a href="#cb59-29"></a><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-30"><a href="#cb59-30"></a><span class="st">  </span><span class="kw">semi_join</span>(gbs_sites <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-31"><a href="#cb59-31"></a><span class="st">  </span><span class="kw">group_by</span>(Chr) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-32"><a href="#cb59-32"></a><span class="st">  </span><span class="kw">nest</span>(<span class="dt">.key =</span> <span class="st">&quot;allSitesPassing&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-33"><a href="#cb59-33"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Sites2Keep=</span><span class="kw">future_map2</span>(Chr,allSitesPassing,<span class="cf">function</span>(Chr,allSitesPassing){ </span>
<span id="cb59-34"><a href="#cb59-34"></a>        pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb59-35"><a href="#cb59-35"></a>        sitesPassing_thisChr&lt;-allSitesPassing <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb59-36"><a href="#cb59-36"></a><span class="st">          </span><span class="kw">select</span>(V1,V2)</span>
<span id="cb59-37"><a href="#cb59-37"></a>        <span class="kw">write.table</span>(sitesPassing_thisChr,</span>
<span id="cb59-38"><a href="#cb59-38"></a>                    <span class="dt">file =</span> <span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb59-39"><a href="#cb59-39"></a>                                  <span class="st">&quot;_ugC1samples_sitesInRefPanelVtoImpute_91019.sites2keep&quot;</span>),</span>
<span id="cb59-40"><a href="#cb59-40"></a>                    <span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">quote =</span> F)}))</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">require</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractRaw_gbsSamples=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb60-4"><a href="#cb60-4"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf /workdir/marnin/June2016_VCF/&quot;</span>,</span>
<span id="cb60-5"><a href="#cb60-5"></a>                  <span class="st">&quot;cassavaGBSbuild_June2016_withRef_chr&quot;</span>,Chr,<span class="st">&quot;.vcf.gz &quot;</span>,</span>
<span id="cb60-6"><a href="#cb60-6"></a>                  <span class="st">&quot;--keep /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span>,</span>
<span id="cb60-7"><a href="#cb60-7"></a>                  <span class="st">&quot;gbsOnlySamplesToImpute_ugC1_90919.txt &quot;</span>,</span>
<span id="cb60-8"><a href="#cb60-8"></a>                  <span class="st">&quot;--chr &quot;</span>,Chr,<span class="st">&quot; &quot;</span>,</span>
<span id="cb60-9"><a href="#cb60-9"></a>                  <span class="st">&quot;--minDP 4 --maxDP 50 &quot;</span>,</span>
<span id="cb60-10"><a href="#cb60-10"></a>                  <span class="st">&quot;--positions /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb60-11"><a href="#cb60-11"></a>                  Chr,<span class="st">&quot;_ugC1samples_sitesInRefPanelVtoImpute_91019.sites2keep &quot;</span>,</span>
<span id="cb60-12"><a href="#cb60-12"></a>                  <span class="st">&quot;--recode --stdout | &quot;</span>,</span>
<span id="cb60-13"><a href="#cb60-13"></a>                  <span class="st">&quot;awk &#39;$4 != </span><span class="ch">\&quot;</span><span class="st">-</span><span class="ch">\&quot;</span><span class="st"> {print}&#39; | awk &#39;$5 != </span><span class="ch">\&quot;</span><span class="st">-</span><span class="ch">\&quot;</span><span class="st"> {print}&#39; | grep -v &#39;INFO=&#39; | &quot;</span>,</span>
<span id="cb60-14"><a href="#cb60-14"></a>                  <span class="st">&quot;bgzip -c -@ 24 &gt; &quot;</span>,</span>
<span id="cb60-15"><a href="#cb60-15"></a>                  <span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb60-16"><a href="#cb60-16"></a>                  Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_Ready2GTimputeWithBeagle5_91119.vcf.gz&quot;</span>)) }))</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1"></a><span class="ex">vcftools</span> --gzvcf /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr1_ugC1samples_FromJune2016vcf_Ready2REFimpute_91019.vcf.gz</span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="fu">zcat</span> /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr1_ugC1samples_FromJune2016vcf_Ready2REFimpute_91019.vcf.gz <span class="kw">|</span> <span class="fu">head</span> -n40 <span class="kw">|</span> <span class="fu">cut</span> -f1-12</span></code></pre></div>
<p>1:29425054 [-]</p>
</div>
<div id="rsync-6" class="section level2">
<h2>Rsync</h2>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># cbsulm__ --&gt; cbsurobbins</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageI_<span class="dv">82819</span></span>
<span id="cb62-3"><a href="#cb62-3"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span></span>
<span id="cb62-4"><a href="#cb62-4"></a></span>
<span id="cb62-5"><a href="#cb62-5"></a><span class="co"># cbsurobbins --&gt; cbsulm__</span></span>
<span id="cb62-6"><a href="#cb62-6"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm15.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb62-7"><a href="#cb62-7"></a></span>
<span id="cb62-8"><a href="#cb62-8"></a></span>
<span id="cb62-9"><a href="#cb62-9"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm17.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb62-10"><a href="#cb62-10"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm16.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb62-11"><a href="#cb62-11"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm14.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb62-12"><a href="#cb62-12"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm13.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb62-13"><a href="#cb62-13"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm12.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span>
<span id="cb62-14"><a href="#cb62-14"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm07.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span></code></pre></div>
</div>
<div id="copy-genetic-map-to-server" class="section level2">
<h2>Copy Genetic Map to server</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1"></a><span class="fu">cp</span> -r ~/CassavaGeneticMap /workdir/mw489/<span class="kw">;</span> <span class="ex">screen</span> -r</span></code></pre></div>
</div>
<div id="cbsulm15-112-1-18" class="section level2">
<h2>cbsulm15 (112) [1-18]</h2>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">18</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_GenotypedSites_GBSonly_ugC1samples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb64-4"><a href="#cb64-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb64-5"><a href="#cb64-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb64-6"><a href="#cb64-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb64-7"><a href="#cb64-7"></a>                  Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_Ready2GTimputeWithBeagle5_91119.vcf.gz &quot;</span>,</span>
<span id="cb64-8"><a href="#cb64-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb64-9"><a href="#cb64-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb64-10"><a href="#cb64-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb64-11"><a href="#cb64-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb64-12"><a href="#cb64-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb64-13"><a href="#cb64-13"></a>                  Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGTmodeGenotypedSites_91119 &quot;</span>,</span>
<span id="cb64-14"><a href="#cb64-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="beaglelogs-3" class="section level2">
<h2>BeagleLogs</h2>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>cd <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>; </span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="co">#mkdir BeagleLogs;</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>cp <span class="op">*</span>_ugC1samples_FromJune2016vcf_REFimputedGTmodeGenotypedSites_<span class="fl">91119.</span>log BeagleLogs<span class="op">/</span></span></code></pre></div>
</div>
<div id="rsync-to-cbsurobbins" class="section level2">
<h2>Rsync to cbsurobbins</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># cbsulm__ --&gt; cbsurobbins</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span></span></code></pre></div>
</div>
<div id="post-impute-filter-3" class="section level2">
<h2>Post-impute filter</h2>
<p>AR2&gt;0.75, P_HWE&gt;1e-20, MAF&gt;0.005 [0.5%]</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">library</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb67-2"><a href="#cb67-2"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PostImputeFilter=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){ </span>
<span id="cb67-5"><a href="#cb67-5"></a>            fileIn&lt;-<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,</span>
<span id="cb67-6"><a href="#cb67-6"></a>                           Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGTmodeGenotypedSites_91119.vcf.gz &quot;</span>)</span>
<span id="cb67-7"><a href="#cb67-7"></a>            fileOut&lt;-<span class="kw">paste0</span>(<span class="st">&quot;--out &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,</span>
<span id="cb67-8"><a href="#cb67-8"></a>                            Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGTmodeGenotypedSites_91119&quot;</span>)</span>
<span id="cb67-9"><a href="#cb67-9"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--get-INFO DR2 --get-INFO AF &quot;</span>,fileOut))</span>
<span id="cb67-10"><a href="#cb67-10"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--hardy &quot;</span>,fileOut)) }))</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>stats2filterOn&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb68-4"><a href="#cb68-4"></a>                                                <span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGTmodeGenotypedSites_91119.INFO&quot;</span>), </span>
<span id="cb68-5"><a href="#cb68-5"></a>                                         <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)),</span>
<span id="cb68-6"><a href="#cb68-6"></a>         <span class="dt">hwe=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb68-7"><a href="#cb68-7"></a>                                               <span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGTmodeGenotypedSites_91119.hwe&quot;</span>), </span>
<span id="cb68-8"><a href="#cb68-8"></a>                                        <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)))</span>
<span id="cb68-9"><a href="#cb68-9"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb68-10"><a href="#cb68-10"></a><span class="st">  </span><span class="kw">select</span>(Chr,INFO,hwe) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-11"><a href="#cb68-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map2</span>(INFO,hwe,<span class="op">~</span><span class="kw">left_join</span>(.x,(.y <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-12"><a href="#cb68-12"></a><span class="st">                                             </span><span class="kw">rename</span>(<span class="dt">CHROM=</span>CHR))))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-13"><a href="#cb68-13"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>hwe)</span>
<span id="cb68-14"><a href="#cb68-14"></a>stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-15"><a href="#cb68-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">NotNumDR2=</span><span class="kw">map_lgl</span>(INFO,<span class="op">~</span><span class="kw">is.numeric</span>(.<span class="op">$</span>DR2)))</span>
<span id="cb68-16"><a href="#cb68-16"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb68-17"><a href="#cb68-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,</span>
<span id="cb68-18"><a href="#cb68-18"></a>                  <span class="op">~</span><span class="kw">mutate</span>(.,</span>
<span id="cb68-19"><a href="#cb68-19"></a>                          <span class="dt">DR2=</span><span class="kw">as.numeric</span>(DR2),</span>
<span id="cb68-20"><a href="#cb68-20"></a>                          <span class="dt">AF=</span><span class="kw">as.numeric</span>(AF)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-21"><a href="#cb68-21"></a><span class="st">                    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(DR2),</span>
<span id="cb68-22"><a href="#cb68-22"></a>                           <span class="op">!</span><span class="kw">is.na</span>(AF))))</span>
<span id="cb68-23"><a href="#cb68-23"></a></span>
<span id="cb68-24"><a href="#cb68-24"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb68-25"><a href="#cb68-25"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,<span class="op">~</span><span class="kw">mutate</span>(.,<span class="dt">MAF=</span><span class="kw">ifelse</span>(AF<span class="op">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span><span class="op">-</span>AF,AF))))</span></code></pre></div>
<p>Check what’s left</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>sitesPassingFilters&lt;-stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">allSitesPassing=</span><span class="kw">map</span>(INFO,</span>
<span id="cb69-3"><a href="#cb69-3"></a>                             <span class="op">~</span><span class="kw">filter</span>(.,DR2<span class="op">&gt;=</span><span class="fl">0.75</span>,</span>
<span id="cb69-4"><a href="#cb69-4"></a>                                     P_HWE<span class="op">&gt;</span><span class="fl">1e-20</span>,</span>
<span id="cb69-5"><a href="#cb69-5"></a>                                     MAF<span class="op">&gt;</span><span class="fl">0.005</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb69-6"><a href="#cb69-6"></a><span class="st">                               </span><span class="kw">select</span>(CHROM,POS))) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb69-7"><a href="#cb69-7"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>INFO)</span>
<span id="cb69-8"><a href="#cb69-8"></a>stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 65120</span></span>
<span id="cb69-9"><a href="#cb69-9"></a>sitesPassingFilters <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(allSitesPassing) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 51152</span></span>
<span id="cb69-10"><a href="#cb69-10"></a>stats2filterOn</span>
<span id="cb69-11"><a href="#cb69-11"></a>sitesPassingFilters</span></code></pre></div>
<p>Apply filter</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>sitesPassingFilters <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PostImputePrePhaseFilter=</span><span class="kw">future_map2</span>(Chr,allSitesPassing,<span class="cf">function</span>(Chr,allSitesPassing){ </span>
<span id="cb70-3"><a href="#cb70-3"></a>        pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb70-4"><a href="#cb70-4"></a>    sitesPassing_thisChr&lt;-allSitesPassing <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-5"><a href="#cb70-5"></a><span class="st">      </span><span class="kw">select</span>(CHROM,POS)</span>
<span id="cb70-6"><a href="#cb70-6"></a>    <span class="kw">write.table</span>(sitesPassing_thisChr,</span>
<span id="cb70-7"><a href="#cb70-7"></a>                <span class="dt">file =</span> <span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb70-8"><a href="#cb70-8"></a>                              <span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGTmodeGenotypedSites_91119.sitesPassing&quot;</span>),</span>
<span id="cb70-9"><a href="#cb70-9"></a>                <span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">quote =</span> F)</span>
<span id="cb70-10"><a href="#cb70-10"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb70-11"><a href="#cb70-11"></a>                  <span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGTmodeGenotypedSites_91119.vcf.gz &quot;</span>,</span>
<span id="cb70-12"><a href="#cb70-12"></a>                  <span class="st">&quot;--positions &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb70-13"><a href="#cb70-13"></a>                  <span class="st">&quot;_ugC1samples_FromJune2016vcf_REFimputedGTmodeGenotypedSites_91119.sitesPassing &quot;</span>,</span>
<span id="cb70-14"><a href="#cb70-14"></a>                  <span class="st">&quot;--recode --stdout | &quot;</span>,</span>
<span id="cb70-15"><a href="#cb70-15"></a>                  <span class="st">&quot;bgzip -c -@ 24 &gt; &quot;</span>,</span>
<span id="cb70-16"><a href="#cb70-16"></a>                  pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb70-17"><a href="#cb70-17"></a>                  <span class="st">&quot;_ugC1samples_FromJune2016vcf_ReadyToPhaseAndImputeUngenotypedSites_91119.vcf.gz&quot;</span>))}))</span></code></pre></div>
</div>
</div>
<div id="impute-ugc1-samples-ungenotyped-sites-ref-impute-gt-mode-beagle-5" class="section level1">
<h1>Impute ugC1 samples @ ungenotyped sites (REF impute, GT mode, Beagle 5)</h1>
<p>Second round of impute for these samples. See if we come out with more markers passing filters…? ## Rsync to cbsulm15</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># cbsurobbins --&gt; cbsulm__</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm15.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span></code></pre></div>
<div id="cbsulm15-112-1-18-1" class="section level2">
<h2>cbsulm15 (112) [1-18]</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">18</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">REFimpute_GenotypedSites_GBSonly_ugC1samples=</span><span class="kw">map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb72-4"><a href="#cb72-4"></a>    nthreads&lt;-<span class="dv">112</span></span>
<span id="cb72-5"><a href="#cb72-5"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;java -Xms2g -Xmx500g -jar /programs/beagle/beagle.jar &quot;</span>,</span>
<span id="cb72-6"><a href="#cb72-6"></a>                  <span class="st">&quot;gt=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb72-7"><a href="#cb72-7"></a>                  Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_ReadyToPhaseAndImputeUngenotypedSites_91119.vcf.gz &quot;</span>,</span>
<span id="cb72-8"><a href="#cb72-8"></a>                  <span class="st">&quot;map=/workdir/mw489/CassavaGeneticMap/chr&quot;</span>,</span>
<span id="cb72-9"><a href="#cb72-9"></a>                  Chr,<span class="st">&quot;_cassava_cM_pred.v6_91019.map &quot;</span>,</span>
<span id="cb72-10"><a href="#cb72-10"></a>                  <span class="st">&quot;ref=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb72-11"><a href="#cb72-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb72-12"><a href="#cb72-12"></a>                  <span class="st">&quot;out=/workdir/mw489/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb72-13"><a href="#cb72-13"></a>                  Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_AllSitesREFimputedAndPhased_91119 &quot;</span>,</span>
<span id="cb72-14"><a href="#cb72-14"></a>                  <span class="st">&quot;nthreads=&quot;</span>,nthreads,<span class="st">&quot; impute=true ne=100000&quot;</span>))}))</span></code></pre></div>
</div>
<div id="beaglelogs-4" class="section level2">
<h2>BeagleLogs</h2>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>cd <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>; </span>
<span id="cb73-2"><a href="#cb73-2"></a>cp <span class="op">*</span>_ugC1samples_FromJune2016vcf_AllSitesREFimputedAndPhased_<span class="fl">91119.</span>log BeagleLogs<span class="op">/</span></span></code></pre></div>
</div>
<div id="rsync-to-cbsurobbins-1" class="section level2">
<h2>Rsync to cbsurobbins</h2>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="co"># cbsulm__ --&gt; cbsurobbins</span></span>
<span id="cb74-2"><a href="#cb74-2"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsurobbins.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span></span></code></pre></div>
</div>
<div id="post-impute-filter-4" class="section level2">
<h2>Post-impute filter</h2>
<p>AR2&gt;0.75, P_HWE&gt;1e-20, MAF&gt;0.005 [0.5%]</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr); <span class="kw">library</span>(furrr); <span class="kw">options</span>(<span class="dt">mc.cores=</span><span class="dv">18</span>); <span class="kw">plan</span>(multiprocess)</span>
<span id="cb75-2"><a href="#cb75-2"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PostImputeFilter=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){ </span>
<span id="cb75-5"><a href="#cb75-5"></a>            fileIn&lt;-<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,</span>
<span id="cb75-6"><a href="#cb75-6"></a>                           Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_AllSitesREFimputedAndPhased_91119.vcf.gz &quot;</span>)</span>
<span id="cb75-7"><a href="#cb75-7"></a>            fileOut&lt;-<span class="kw">paste0</span>(<span class="st">&quot;--out &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,</span>
<span id="cb75-8"><a href="#cb75-8"></a>                            Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_AllSitesREFimputedAndPhased_91119&quot;</span>)</span>
<span id="cb75-9"><a href="#cb75-9"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--get-INFO DR2 --get-INFO AF &quot;</span>,fileOut))</span>
<span id="cb75-10"><a href="#cb75-10"></a>            <span class="kw">system</span>(<span class="kw">paste0</span>(fileIn,<span class="st">&quot;--hardy &quot;</span>,fileOut)) }))</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb76-2"><a href="#cb76-2"></a>stats2filterOn&lt;-<span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb76-4"><a href="#cb76-4"></a>                                                <span class="st">&quot;_ugC1samples_FromJune2016vcf_AllSitesREFimputedAndPhased_91119.INFO&quot;</span>), </span>
<span id="cb76-5"><a href="#cb76-5"></a>                                         <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)),</span>
<span id="cb76-6"><a href="#cb76-6"></a>         <span class="dt">hwe=</span><span class="kw">future_map</span>(Chr,<span class="op">~</span><span class="kw">read.table</span>(<span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,.,</span>
<span id="cb76-7"><a href="#cb76-7"></a>                                               <span class="st">&quot;_ugC1samples_FromJune2016vcf_AllSitesREFimputedAndPhased_91119.hwe&quot;</span>), </span>
<span id="cb76-8"><a href="#cb76-8"></a>                                        <span class="dt">stringsAsFactors =</span> F, <span class="dt">header =</span> T)))</span>
<span id="cb76-9"><a href="#cb76-9"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb76-10"><a href="#cb76-10"></a><span class="st">  </span><span class="kw">select</span>(Chr,INFO,hwe) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-11"><a href="#cb76-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map2</span>(INFO,hwe,<span class="op">~</span><span class="kw">left_join</span>(.x,(.y <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-12"><a href="#cb76-12"></a><span class="st">                                             </span><span class="kw">rename</span>(<span class="dt">CHROM=</span>CHR))))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-13"><a href="#cb76-13"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>hwe)</span>
<span id="cb76-14"><a href="#cb76-14"></a>stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-15"><a href="#cb76-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">NotNumDR2=</span><span class="kw">map_lgl</span>(INFO,<span class="op">~</span><span class="kw">is.numeric</span>(.<span class="op">$</span>DR2)))</span>
<span id="cb76-16"><a href="#cb76-16"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb76-17"><a href="#cb76-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,</span>
<span id="cb76-18"><a href="#cb76-18"></a>                  <span class="op">~</span><span class="kw">mutate</span>(.,</span>
<span id="cb76-19"><a href="#cb76-19"></a>                          <span class="dt">DR2=</span><span class="kw">as.numeric</span>(DR2),</span>
<span id="cb76-20"><a href="#cb76-20"></a>                          <span class="dt">AF=</span><span class="kw">as.numeric</span>(AF)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-21"><a href="#cb76-21"></a><span class="st">                    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(DR2),</span>
<span id="cb76-22"><a href="#cb76-22"></a>                           <span class="op">!</span><span class="kw">is.na</span>(AF))))</span>
<span id="cb76-23"><a href="#cb76-23"></a></span>
<span id="cb76-24"><a href="#cb76-24"></a>stats2filterOn <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb76-25"><a href="#cb76-25"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">INFO=</span><span class="kw">map</span>(INFO,<span class="op">~</span><span class="kw">mutate</span>(.,<span class="dt">MAF=</span><span class="kw">ifelse</span>(AF<span class="op">&gt;</span><span class="fl">0.5</span>,<span class="dv">1</span><span class="op">-</span>AF,AF))))</span></code></pre></div>
<p>Check what’s left</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>sitesPassingFilters&lt;-stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">allSitesPassing=</span><span class="kw">map</span>(INFO,</span>
<span id="cb77-3"><a href="#cb77-3"></a>                             <span class="op">~</span><span class="kw">filter</span>(.,DR2<span class="op">&gt;=</span><span class="fl">0.75</span>,</span>
<span id="cb77-4"><a href="#cb77-4"></a>                                     P_HWE<span class="op">&gt;</span><span class="fl">1e-20</span>,</span>
<span id="cb77-5"><a href="#cb77-5"></a>                                     MAF<span class="op">&gt;</span><span class="fl">0.005</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-6"><a href="#cb77-6"></a><span class="st">                               </span><span class="kw">select</span>(CHROM,POS))) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb77-7"><a href="#cb77-7"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>INFO)</span>
<span id="cb77-8"><a href="#cb77-8"></a>stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 65113</span></span>
<span id="cb77-9"><a href="#cb77-9"></a>sitesPassingFilters <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>(allSitesPassing) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">nrow</span>() <span class="co"># 56250</span></span>
<span id="cb77-10"><a href="#cb77-10"></a>stats2filterOn <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(sitesPassingFilters)</span>
<span id="cb77-11"><a href="#cb77-11"></a><span class="co">#  Chr INFO                      allSitesPassing         </span></span>
<span id="cb77-12"><a href="#cb77-12"></a><span class="co">#    &lt;int&gt; &lt;list&gt;                    &lt;list&gt;                  </span></span>
<span id="cb77-13"><a href="#cb77-13"></a><span class="co">#  1     1 &lt;data.frame [8,201 x 13]&gt; &lt;data.frame [7,254 x 2]&gt;</span></span>
<span id="cb77-14"><a href="#cb77-14"></a><span class="co">#  2     2 &lt;data.frame [3,854 x 13]&gt; &lt;data.frame [3,131 x 2]&gt;</span></span>
<span id="cb77-15"><a href="#cb77-15"></a><span class="co">#  3     3 &lt;data.frame [4,102 x 13]&gt; &lt;data.frame [3,536 x 2]&gt;</span></span>
<span id="cb77-16"><a href="#cb77-16"></a><span class="co">#  4     4 &lt;data.frame [3,756 x 13]&gt; &lt;data.frame [3,422 x 2]&gt;</span></span>
<span id="cb77-17"><a href="#cb77-17"></a><span class="co">#  5     5 &lt;data.frame [3,807 x 13]&gt; &lt;data.frame [3,424 x 2]&gt;</span></span>
<span id="cb77-18"><a href="#cb77-18"></a><span class="co">#  6     6 &lt;data.frame [3,594 x 13]&gt; &lt;data.frame [2,861 x 2]&gt;</span></span>
<span id="cb77-19"><a href="#cb77-19"></a><span class="co">#  7     7 &lt;data.frame [1,959 x 13]&gt; &lt;data.frame [1,538 x 2]&gt;</span></span>
<span id="cb77-20"><a href="#cb77-20"></a><span class="co">#  8     8 &lt;data.frame [3,628 x 13]&gt; &lt;data.frame [3,144 x 2]&gt;</span></span>
<span id="cb77-21"><a href="#cb77-21"></a><span class="co">#  9     9 &lt;data.frame [3,449 x 13]&gt; &lt;data.frame [2,902 x 2]&gt;</span></span>
<span id="cb77-22"><a href="#cb77-22"></a><span class="co"># 10    10 &lt;data.frame [2,901 x 13]&gt; &lt;data.frame [2,486 x 2]&gt;</span></span>
<span id="cb77-23"><a href="#cb77-23"></a><span class="co"># 11    11 &lt;data.frame [3,297 x 13]&gt; &lt;data.frame [2,702 x 2]&gt;</span></span>
<span id="cb77-24"><a href="#cb77-24"></a><span class="co"># 12    12 &lt;data.frame [2,893 x 13]&gt; &lt;data.frame [2,604 x 2]&gt;</span></span>
<span id="cb77-25"><a href="#cb77-25"></a><span class="co"># 13    13 &lt;data.frame [2,773 x 13]&gt; &lt;data.frame [2,378 x 2]&gt;</span></span>
<span id="cb77-26"><a href="#cb77-26"></a><span class="co"># 14    14 &lt;data.frame [4,172 x 13]&gt; &lt;data.frame [3,830 x 2]&gt;</span></span>
<span id="cb77-27"><a href="#cb77-27"></a><span class="co"># 15    15 &lt;data.frame [3,959 x 13]&gt; &lt;data.frame [3,284 x 2]&gt;</span></span>
<span id="cb77-28"><a href="#cb77-28"></a><span class="co"># 16    16 &lt;data.frame [2,875 x 13]&gt; &lt;data.frame [2,519 x 2]&gt;</span></span>
<span id="cb77-29"><a href="#cb77-29"></a><span class="co"># 17    17 &lt;data.frame [2,775 x 13]&gt; &lt;data.frame [2,545 x 2]&gt;</span></span>
<span id="cb77-30"><a href="#cb77-30"></a><span class="co"># 18    18 &lt;data.frame [3,118 x 13]&gt; &lt;data.frame [2,690 x 2]&gt;</span></span></code></pre></div>
<p>Apply filter</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>sitesPassingFilters <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PostImputePrePhaseFilter=</span><span class="kw">future_map2</span>(Chr,allSitesPassing,<span class="cf">function</span>(Chr,allSitesPassing){ </span>
<span id="cb78-3"><a href="#cb78-3"></a>        pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb78-4"><a href="#cb78-4"></a>    sitesPassing_thisChr&lt;-allSitesPassing <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="st">      </span><span class="kw">select</span>(CHROM,POS)</span>
<span id="cb78-6"><a href="#cb78-6"></a>    <span class="kw">write.table</span>(sitesPassing_thisChr,</span>
<span id="cb78-7"><a href="#cb78-7"></a>                <span class="dt">file =</span> <span class="kw">paste0</span>(pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb78-8"><a href="#cb78-8"></a>                              <span class="st">&quot;_ugC1samples_FromJune2016vcf_AllSitesREFimputedAndPhased_91119.sitesPassing&quot;</span>),</span>
<span id="cb78-9"><a href="#cb78-9"></a>                <span class="dt">row.names =</span> F, <span class="dt">col.names =</span> F, <span class="dt">quote =</span> F)</span>
<span id="cb78-10"><a href="#cb78-10"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb78-11"><a href="#cb78-11"></a>                  <span class="st">&quot;_ugC1samples_FromJune2016vcf_AllSitesREFimputedAndPhased_91119.vcf.gz &quot;</span>,</span>
<span id="cb78-12"><a href="#cb78-12"></a>                  <span class="st">&quot;--positions &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb78-13"><a href="#cb78-13"></a>                  <span class="st">&quot;_ugC1samples_FromJune2016vcf_AllSitesREFimputedAndPhased_91119.sitesPassing &quot;</span>,</span>
<span id="cb78-14"><a href="#cb78-14"></a>                  <span class="st">&quot;--recode --stdout | &quot;</span>,</span>
<span id="cb78-15"><a href="#cb78-15"></a>                  <span class="st">&quot;bgzip -c -@ 24 &gt; &quot;</span>,</span>
<span id="cb78-16"><a href="#cb78-16"></a>                  pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb78-17"><a href="#cb78-17"></a>                  <span class="st">&quot;_ugC1samples_FromJune2016vcf_ReadyToMergeWithRefPanel_91119.vcf.gz&quot;</span>))}))</span></code></pre></div>
</div>
</div>
<div id="form-imputation-refpanelvi" class="section level1">
<h1>Form Imputation RefPanelVI</h1>
<div id="apply-filter-to-refpanelv-vcf" class="section level2">
<h2>Apply filter to RefPanelV VCF</h2>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ExtractRefPanelIVsamplesForStageV=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb79-3"><a href="#cb79-3"></a>    <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;vcftools --gzvcf /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb79-4"><a href="#cb79-4"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageV_91019.vcf.gz &quot;</span>,</span>
<span id="cb79-5"><a href="#cb79-5"></a>                  <span class="st">&quot;--chr &quot;</span>,Chr,<span class="st">&quot; &quot;</span>,</span>
<span id="cb79-6"><a href="#cb79-6"></a>                  <span class="st">&quot;--positions /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb79-7"><a href="#cb79-7"></a>                  Chr,<span class="st">&quot;_ugC1samples_FromJune2016vcf_AllSitesREFimputedAndPhased_91119.sitesPassing &quot;</span>,</span>
<span id="cb79-8"><a href="#cb79-8"></a>                  <span class="st">&quot;--recode &quot;</span>,</span>
<span id="cb79-9"><a href="#cb79-9"></a>                  <span class="st">&quot;--stdout | bgzip -c -@ 24 &gt; &quot;</span>,</span>
<span id="cb79-10"><a href="#cb79-10"></a>                  <span class="st">&quot; /workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/chr&quot;</span>,</span>
<span id="cb79-11"><a href="#cb79-11"></a>                  Chr,<span class="st">&quot;_ImputationReferencePanel_StageVsamples_ReadyToMergeAndFormStageVI_91119.vcf.gz&quot;</span>)) }))</span></code></pre></div>
</div>
<div id="merge-refpanelv-and-ugc1-samples" class="section level2">
<h2>Merge RefPanelV and ugC1 samples</h2>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="kw">library</span>(tidyverse); <span class="kw">library</span>(magrittr);</span>
<span id="cb80-2"><a href="#cb80-2"></a>pathIn&lt;-<span class="st">&quot;/workdir/marnin/nextgenImputation2019/ImputationEastAfrica_StageII_90919/&quot;</span></span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Index=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb80-5"><a href="#cb80-5"></a>        <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;tabix -f -p vcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb80-6"><a href="#cb80-6"></a>                      <span class="st">&quot;_ImputationReferencePanel_StageVsamples_ReadyToMergeAndFormStageVI_91119.vcf.gz&quot;</span>))</span>
<span id="cb80-7"><a href="#cb80-7"></a>        <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;tabix -f -p vcf &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb80-8"><a href="#cb80-8"></a>                      <span class="st">&quot;_ugC1samples_FromJune2016vcf_ReadyToMergeWithRefPanel_91119.vcf.gz&quot;</span>)) }))</span>
<span id="cb80-9"><a href="#cb80-9"></a>    </span>
<span id="cb80-10"><a href="#cb80-10"></a><span class="kw">tibble</span>(<span class="dt">Chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span>) <span class="op">%&gt;%</span></span>
<span id="cb80-11"><a href="#cb80-11"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Merge=</span><span class="kw">future_map</span>(Chr,<span class="cf">function</span>(Chr){</span>
<span id="cb80-12"><a href="#cb80-12"></a>        <span class="kw">system</span>(<span class="kw">paste0</span>(<span class="st">&quot;bcftools merge &quot;</span>,</span>
<span id="cb80-13"><a href="#cb80-13"></a>                      <span class="st">&quot;--output &quot;</span>,pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb80-14"><a href="#cb80-14"></a>                      <span class="st">&quot;_ImputationReferencePanel_StageVI_91119.vcf.gz &quot;</span>,</span>
<span id="cb80-15"><a href="#cb80-15"></a>                      <span class="st">&quot;--merge snps --output-type z --threads 24 &quot;</span>,</span>
<span id="cb80-16"><a href="#cb80-16"></a>                      pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb80-17"><a href="#cb80-17"></a>                      <span class="st">&quot;_ImputationReferencePanel_StageVsamples_ReadyToMergeAndFormStageVI_91119.vcf.gz &quot;</span>,</span>
<span id="cb80-18"><a href="#cb80-18"></a>                      pathIn,<span class="st">&quot;chr&quot;</span>,Chr,</span>
<span id="cb80-19"><a href="#cb80-19"></a>                      <span class="st">&quot;_ugC1samples_FromJune2016vcf_ReadyToMergeWithRefPanel_91119.vcf.gz&quot;</span>))}))</span></code></pre></div>
</div>
<div id="rsync-to-cbsulm15" class="section level2">
<h2>Rsync to cbsulm15</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="co"># cbsurobbins --&gt; cbsulm__</span></span>
<span id="cb81-2"><a href="#cb81-2"></a>rsync <span class="op">--</span>update <span class="op">--</span>archive <span class="op">--</span>verbose <span class="op">/</span>workdir<span class="op">/</span>marnin<span class="op">/</span>nextgenImputation2019<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span><span class="op">/</span><span class="st"> </span>mw489<span class="op">@</span>cbsulm15.biohpc.cornell.edu<span class="op">:</span><span class="er">/</span>workdir<span class="op">/</span>mw489<span class="op">/</span>ImputationEastAfrica_StageII_<span class="dv">90919</span>;</span></code></pre></div>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
